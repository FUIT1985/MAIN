                                   Con gurazione di
                                   base: rete, accounts,
                                   stampa ...
                                                                                                                                Capitolo 8
                                   8. Con gurazione di base: rete, accounts, stampa ...                                                      pag. 145
                                            1. Come con gurare il Sistema per un'altra lingua                                                pag. 146
                                                      1. Come impostare la lingua prede nita                                                 pag. 146
                                                      2. Come con gurare la tastiera                                                         pag. 147
                                                      3. Migrazione a UTF-8                                                                  pag. 148
                                            2. Come con gurare la rete                                                                       pag. 149
                                                      1. Interfaccia Ethernet                                                                pag. 150
                                                      2. La connessione PPP tramite modem PSTN                                               pag. 151
                                                      3. La connessione tramite modem ADSL                                                   pag. 152
                                                                 1. I Modems che supportano PPPOE                                            pag. 152
                                                                 2. I Modems che supportano PPTP                                             pag. 153
                                                                 3. I Modems che supportano DHCP                                             pag. 153
                                                      4. Con gurazione della rete automatica per i Roaming Users                             pag. 153
                                            3. Assegnazione dell'Hostname e Con gurazione del Name Service                                   pag. 154
                                                      1. Risoluzione dei nomi                                                                pag. 155
                                                                 1. Con gurazione del server DNS                                             pag. 155
                                                                 2. Il le /etc/hosts                                                         pag. 156
                                            4. Database utenti e gruppi                                                                      pag. 156
                                                      1. Elenco degli utenti: /etc/passwd                                                    pag. 157
                                                      2. Il le /etc/shadow, criptato e nascosto                                              pag. 157
                                                      3. Modi ca un account o una password esistenti                                         pag. 158
                                                      4. Come bloccare un account                                                            pag. 158
                                                      5. Elenco dei gruppi: /etc/group                                                       pag. 158
                                            5. Creazione degli accounts                                                                      pag. 159
                                            6. Ambiente Shell                                                                                pag. 160
                                            7. Come con gurare la stampante                                                                  pag. 162
                                            8. Con gurazione del Bootloader                                                                  pag. 162
                                                      1. Come identi care i vostri dischi                                                    pag. 163
                                                      2. Con gurazione di LILO                                                               pag. 165
                                                      3. La con gurazione di GRUB 2                                                          pag. 166
                                                      4. Macintosh (PowerPC): con gurazione Yaboot                                           pag. 167
                                            9. Altre con gurazioni: sincronizzazione dell'orologio, logs, condivisione                       pag. 168
                                                      1. Timezone - Fuso orario                                                              pag. 168
                                                      2. Sincronizzazione dell'orologio                                                      pag. 169
                                                                 1. Per le Workstations                                                      pag. 170
                                                                 2. Per i servers                                                            pag. 170
                                                      3. Log Rotation                                                                        pag. 170
                                                      4. Condivisione dei diritti di amministratore                                          pag. 171
                                                      5. Elenco dei Mount Points                                                             pag. 171
                                                      6. locate e updatedb                                                                   pag. 173
                                            10. Come compilare un kernel                                                                     pag. 173
                                                      1. Introduzione e Prerequisiti                                                         pag. 174
                                                      2. Come recuperare le Sorgenti                                                         pag. 174
                                                      3. Con gurazione del kernel                                                            pag. 175
                                                      4. Compiling [letteralmente "compilazione"] e Building [letteralmente "costruzione",   pag. 176
                                                      "generazione"] di un pacchetto
                                                      5. Compilazione dei moduli esterni                                                     pag. 177
                                                      6. Come applicare una patch del kernel                                                 pag. 178
                                            11. Installazione di un kernel                                                                   pag. 179
                                                      1. Funzionalità di Debian Kernel Package                                               pag. 179
                                                      2. Installazione con dpkg                                                              pag. 179



                                   <<Lo scopo di una nuova installazione attraverso debian-installer è quello di rendere la macchina
                                   quanto più funzionante possibile, ma rimarranno comunque molti servizi da con gurare. Inoltre, è
                                   sempre utile conoscere come modi care i diversi elementi di con gurazione, de niti durante il
                                   processo d’installazione iniziale>>
fi
fi
     fi
     fi
     fi
     fi
     fi
     fi
          fi
               fi
                    fi
                    fi
                     fi
                         fi
                         fi
                              fi
                                        fi
                                                fi
                                                     fi
                                                          fi
                                                               fi
                                                                                                    fi
                                                                                                                      fi
                                                                                                                           fi
                          Questo capitolo tratta tutto ciò che rientra in quello che potremo de nire una "con gurazione di
                          base": networking, lingua ed i "locales" [il "locale", in informatica, è un insieme di parametri
                          impostati dall'utente che riguardano la lingua, la regione ed eventuali preferenze speciali in merito
                          all'interfaccia utente.], utenti e gruppi, stampa, mount points, ecc.

                          8.1. Come con gurare il Sistema per un'altra lingua

                          Se il sistema è stato installato utilizzando la lingua francese, è probabile che sulla macchina sia già
                          impostata come lingua prede nita il francese. Ma è meglio conoscere come l'installer imposta la
                          lingua in modo che possiate apportare modi che in caso di necessità.

                                    STRUMENTI                                Il comando locale elenca, attraverso un riepilogo della con gurazione corrente, i
                                          TOOLS                              diversi parametri “locales” (formato data, numbers format, ecc.), presentandoli
                                                                             sotto forma di un insieme di “variabili di ambiente standard” dedicate alla “modi ca
                               Il comando                                    dinamica” di queste impostazioni.
                               locale per                                    [Una variabile di ambiente è un valore con nome dinamico che può in uire sul
                               visualizzare la                               funzionamento dei processi in esecuzione su un computer. La “modi ca dinamica”,
                               con gurazione                                 possibile grazie a delle regole ed a dei criteri (campi chiave), è una modi ca ex post
                               corrente                                      ad una pregressa analisi e ad un campionamento dei dati, che ha per obiettivo un
                                                                             determinato “livello di qualità” e di conseguenza consente una reazione essibile ai
                                                                             summenzionati dati raccolti.]


                          8.1.1. Come impostare la lingua prede nita

                          Un "locale" è un'insieme di impostazioni regionali [internazionali]. Tale insieme non include solo la
                          lingua del testo, bensì anche il formato di visualizzazione dei numeri, delle date e degli orari e delle
                          valute monetarie [per eventuali calcoli o conversioni], nonché la modalità di confronto alfabetica
                          (per tenere conto propriamente dei caratteri accentati). Sebbene ciascuno di questi parametri possa
                          essere speci cato indipendentemente dagli altri, generalmente avrete necessità di utilizzare solo "un
                          locale", in quanto di per sé un insieme compatto di valori per questo tipo di parametri che
                          corrispondono a loro volta ad una "regione" in senso ampio. I "locales" sono generalmente indicati
                          nel formato code-language_CODE-COUNTRY con talvolta un suf sso per speci carne il set di
                          caratteri e la codi ca che verrano impiegati se li selezionerete. Ciò consente di tenere conto delle
                          differenze idiomatiche o tipogra che tra le diverse regioni con un linguaggio comune.


                                       CULTURA                               Ogni locale è storicamente associato ad un “set di caratteri” (ovvero un insieme di
                                                                             caratteri noti) e ad una prescelta “codi ca” (la codi ca è il modo in cui sono
                               Set di caratteri
                                                                             rappresentati i caratteri nel computer).
                                                                             Le codi che più popolari per le lingue latine erano limitate a 256 caratteri in quanto
                                                                             utilizzavano un byte per carattere. Dal momento che questa limitazione a 256
                                                                             caratteri non consentiva di coprire suf cientemente tutte le lingue Europee, furono
                                                                             necessarie molteplici codi che e così giunsero fra noi, in mezzo alle altre,
                                                                             dall’ISO-8859-1 (nota come “Latin 1”) sino all’ISO-8859-15 (“Latin 9”).
                                                                             Gli incarichi con lingue straniere, spesso implicavano regolari switches fra le
                                                                             codi che ed i sets di caratteri. Inoltre, la redazione di documenti multilingue
                                                                             talvolta comportava problemi quasi insormontabili. Unicode (un super catalogo di
                                                                             quasi tutti i sistemi di scrittura linguistica nel mondo) è stato creato per aggirare
                                                                             questo problema. La sua speciale codi ca UTF-8 conserva tutti i 128 simboli ASCII
                                                                             (con codi ca a 7 bit), ma gestisce gli altri caratteri in modo differente. Questi sono
                                                                             preceduti da una speci ca sequenza escape di pochi bits, che implicitamente
                                                                             de nisce la lunghezza del carattere. [Una sequenza di escape è una combinazione di
                                                                             caratteri e ha un signi cato diverso dai caratteri letterali in essa contenuti; è
                                                                             contrassegnata da uno o più caratteri precedenti (e possibilmente terminanti)]. Ciò
                                                                             consente di codi care tutti i caratteri Unicode su uno o più bytes. L’uso di UTF-8 è
                                                                             diventato molto diffuso, per via del fatto che si tratta della codi ca prede nita dei
                                                                             documenti XML.
                                                                             Questa codi ca dovrebbe essere quella generalmente usata, difatti è di default sui
                                                                             sistemi Debian.




                          Pagina 146 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
      fi
           fi
                fi
                     fi
                          fi
                                fi
                                fi
                                     fi
                                          fi
                                               fi
                                                    fi
                                                         fl
                                                              fi
                                                                   fi
                                                                        fi
                                                                        fi
                                                                                 fi
                                                                                      fi
                                                                                           fi
                                                                                                fi
                                                                                                     fi
                                                                                                          fi
                                                                                                               fl
                                                                                                                    fi
                                                                                                                         fi
                                                                                                                         fl
                                                                                                                              fi
                                                                                                                                   fi
                                                                                                                                        fi
                                                                                                                                             fi
                                                                                                                                                  fi
                    Il pacchetto 1ocales include gli elementi necessari per il corretto funzionamento delle
                    "localizzazioni" delle diverse applicazioni. Durante l'installazione, questo pacchetto pone alcune
                    domande per selezionare il set delle lingue supportate. Questo set può essere cambiato in qualsiasi
                    momento eseguendo da root dpkg-reconfigure locales.

                    La prima domanda vi invita a scegliere i "locales" da supportare. La selezione di tutti i locales
                    inglesi (ovvero quelli che iniziano con “en_”) è una scelta ragionevole. Non esitate a selezionare altri
                    locales se la macchina ospita utenti stranieri. L'elenco di locales abilitati sul sistema è memorizzato
                    nel le /etc/locale.gen. Potrete modi care manualmente questo le, ma dovrete ricordare di
                    eseguire locale-gen dopo ogni modi ca. locale-gen generà i les necessari per il corretto
                    funzionamento dei locales aggiunti, eliminando i les obsoleti.

                    La seconda domanda, intitolata "Default locale for the system environment", richiede di impostare
                    un locale come default. La scelta raccomandata per gli utenti USA è "en_US.UTF-8". Gli utenti
                    dell'Inghilterra potranno fare riferimento a "en_GB.UTF-8". Per la Francia è "fr_FR.UTF-8". I
                    francofoni potranno scegliere: del Belgio "fr_BE.UTF-8"; del Lussemburgo "fr_LU.UTF-8", della
                    Svizzera "fr_CH.UTF-8"; ed i canadesi "fr_CA.UTF-8" o "en_CA.UTF-8" (se anglofoni). Il le /etc/
                    default/locale sarà quindi modi cato per conservare la locale scelta. Dopodiché questo le sarà
                    ripreso da tutte le sessioni-utente dal momento che il modulo PAM effettuerà un'injection del suo
                    stesso contenuto nella variabile di ambiente LANG. [Un pluggable authentication module (PAM) è un
                    meccanismo per integrare più schemi di autenticazione di basso livello in un'API (Application
                    Programming Interface) di alto livello. Ciò consente ai programmi che si basano sull'autenticazione
                    di essere scritti indipendentemente dallo schema di autenticazione sottostante].


                               DIETRO LE              Il le /etc/environment supporta i programmi login, gdm o lo stesso ssh per la
                                  QUINTE              creazione delle corrette variabili d’ambiente. Queste applicazioni non creano le
                     /etc/                            variabili direttamente, ma tramite un modulo PAM (pam_env.so). PAM (Pluggable
                     environment e /                  Authentication Module) è una libreria modulare che centralizza i meccanismi di
                                                      autenticazione, session initialization e password management. Andate a leggere il
                     etc/default/                     paragrafo 11.7.3.2 “Come con gurare PAM” a pag. 288 per avere un esempio sulla
                     locale                           con gurazione di PAM.
                                                      Il le /etc/defualt/locale funziona allo stesso modo, ma contiene solo la
                                                      variabile di ambiente LANG. Grazie a questa separazione alcuni utenti PAM possono
                                                      ereditare un ambiente senza localizzazione. In realtà non è consigliabile eseguire i
                                                      programmi server con la localizzazione abilitata; mentre si raccomandano la
                                                      localizzazione e le impostazioni “regionali” [internazionali] per i programmi che
                                                      aprono le sessioni utente.



                    8.1.2. Come con gurare la tastiera

                    Sebbene il layout della tastiera sia gestito in modo diverso nella modalità gra ca rispetto alla
                    console, Debian fornisce un'unica interfaccia di con gurazione che funziona per entrambe: questa
                    interfaccia è basata su Debconf ed è implementata dal pacchetto keyboard-configuration.
                    Pertanto il comando dpkg-reconfigure keyboard-configuration può essere utilizzato in
                    qualsiasi momento per ricon gurare il layout della tastiera.

                    Le domande riguardano il layout della tastiera sica (una tastiera per PC standard negli USA sarà
                    una "Generic 104 Key" mentre in Francia sarà una "Generic 105 Key - Intl"), quindi in merito al
                    layout da scegliere (generalmente US negli USA), e poi sulla posizione del tasto AltGr (right Alt).
                    In ne viene posta una domanda sulla posizione da utilizzare per il "tasto Compose", che consente di
                    inserire caratteri speciali combinando singoli caratteri. Ad esempio digitando consecutivamente il
                    tasto "Compose" ed il tasto "e" produrrete un accento acuto ("é"). Tutte queste combinazioni sono
                    descritte nel le /usr/share/X11/locale/en_US.UTF-8/Compose (o in un altro le, determinato
                    in base al "locale" corrente indicato da /usr/share/X11/locale/compose.dir).




                                                                 TDAH_1.0           Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 147
fi
fi
     fi
          fi
               fi
                     fi
                          fi
                                  fi
                                       fi
                                            fi
                                                 fi
                                                       fi
                                                            fi
                                                                     fi
                                                                          fi
                                                                               fi
                                                                                                 fi
                                                                                                       fi
                                                                                                                  fi
                                                                                                                         fi
                                                                                                                              fi
                                                                                                                                   fi
                                                                                                                                          

               Occorre precisare che la con gurazione della tastiera per la modalità gra ca qui descritta in uisce
               solo sul layout prede nito; gli ambienti desktop GNOME e KDE, così come gli altri, forniscono un
               pannello di controllo della tastiera nelle loro preferenze, consentendo a ciascun utente di avere il
               proprio layout. Alcune opzioni aggiuntive riguardanti il comportamento di alcuni tasti particolari
               sono disponibili anche nei suddetti pannelli di controllo.


               8.1.3. Migrazione a UTF-8

               La standardizzazione della codi ca UTF-8 è stata una soluzione molto attesa per risolvere le
               molteplici problematiche di interoperabilità, poiché incentiva lo scambio [di dati] internazionale e
               rimuove i limiti decisionali in merito ai caratteri che possono essere utilizzati in un documento.
               L'aspetto negativo è che abbiamo dovuto attraversare una fase di conversione piuttosto dif coltosa.
               Dal momento che rischiava di non essere completamente cristallina (o perlomeno non sincronizzata
               in tutto il mondo), furono necessarie due operazioni di conversione: una sui contenuti dei les, una
               sui lenames. Fortunatamente, la maggior parte della suddetta migrazione è stata completata e
               viene argomentata meramente come citazione.



                                 CULTURA                                Se un testo viene trasmesso (o memorizzato) senza “encoding information”, non è
                         Mojibake e gli                                 detto che il destinatario sia in grado di individuare con certezza quale convenzione
                                                                        utilizzare per interpretare il signi cato di ciò che in n dei conti è un insieme di
                         errori di
                                                                        bytes. [Genericamente “l’econding information” è un’informazione che individua
                         interpretazione                                univocamente la codi ca applicata]. Di solito è possibile farsi un’idea attraverso
                                                                        un’analisi statistica sulla distribuzione dei valori presenti nel testo, ma questo non
                                                                        vi darà una risposta certa. Quando lo enconding system scelto per la lettura
                                                                        differisce da quello utilizzato per la scrittura, i bytes vengono interpretati in modo
                                                                        errato e nella migliore delle ipotesi si ottengono degli errori in alcuni caratteri,
                                                                        mentre nel peggiore dei casi qualcosa di completamente illeggibile.
                                                                        Pertanto, se un testo in francese è apparentemente normale ad eccezione delle
                                                                        lettere accentate e di alcuni simboli, che sono stati sostituiti da sequenze di
                                                                        caratteri del tipo “Ã©”,“Ã ̈” o “Ã§”, è probabilmente un le codi cato in UTF-8 ma
                                                                        interpretato come ISO-8859-1 o ISO-8859-15. Ciò signi ca che l’installazione locale
                                                                        non è ancora stata migrata a UTF-8. Se, d’altra parte, vengono visualizzati dei punti
                                                                        interrogativi al posto delle lettere accentate - oppure se i suddetti punti
                                                                        interrogativi hanno apparentemente sostituito un carattere che avrebbe dovuto
                                                                        seguire la summenzionata lettera accentata, è probabile che l’installazione sia già
                                                                        stata con gurata in UTF-8 e che vi è stato inviato un documento codi cato in
                                                                        ISO-8859-*.
                                                                        Quanto espresso riguarda i casi “semplici”. Questi casi si veri cano solo per le
                                                                        culture occidentali, perché Unicode (e UTF-8) è stato progettato per massimizzare i
                                                                        punti comuni delle codi che storiche per le lingue occidentali basate sull’alfabeto
                                                                        latino, consentendo il riconoscimento delle parti del testo in cui i caratteri sono
                                                                        mancanti.
                                                                        Diversamente nelle con gurazioni più complesse, dove ad esempio due ambienti
                                                                        sono associati a due lingue diverse che non usano lo stesso alfabeto, otterrete
                                                                        spesso dei risultati illeggibili - una successione di simboli astratti che non hanno
                                                                        nulla a che fare con le due suddette lingue. Questa situazione è particolarmente
                                                                        frequente in Asia, a causa delle molteplicità delle lingue e dei sistemi di scrittura. La
                                                                        parola giapponese mojibake è stata adottata per designare questo fenomeno.
                                                                        Quando si veri ca, la diagnostica è più complessa e la soluzione più semplice è
                                                                        spesso migrare a UTF-8 in entrambi gli ambienti.


               Riguardo ai lenames, la migrazione può essere relativamente semplice. Il tool convmv (contenuto
               nel pacchetto omonimo) è stato appositamente scritto per questo scopo; consente di rinominare i
                les da una codi ca all'altra. L'uso di questo strumento è relativamente semplice, ma vi consigliamo
               di farlo in due fasi per evitare sorprese. L'esempio seguente mostra un ambiente UTF-8 che contiene i
               nomi delle directories codi cati in IS0-8859-15 e come utilizzare convmv per la loro
               ridenominazione.




               Pagina 148 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
          fi
               fi
                    fi
                           fi
                                fi
                                     fi
                                          fi
                                               fi
                                                    fi
                                                         fi
                                                              fi
                                                                   fi
                                                                                    fi
                                                                                         fi
                                                                                              fi
                                                                                                   fi
                                                                                                        fi
                                                                                                             fi
                                                                                                                   fi
                                                                                                                                       fi
                                                                                                                                            fi
                                                                                                                                                 fl
               $ ls travail/
               Ic?nes ?1?ments graphiques Textes
               $ convmv -r -f iso-8859-15 -t utf-8 travail/
               Starting a dry run without changes...
               mv "travail/lments graphiques" "travail/Éléments graphiques"
               mv "travail/Icnes" "travail/Icônes"
               No changes to your files done. Use --notest to finally rename the files.
               $ convmv -r --notest -f iso-8859-15 -t utf-8 travail/
               mv "travail/lments graphiques" "travail/Éléments graphiques"
               mv "travail/Icnes" "travail/Icônes"
               Ready!
               $ ls travail/
               Éléments graphiques Icónes Textes

               Per il contenuto dei les, la procedura di conversione sarà più complessa, a causa della molteplicità
               dei formati di les esistenti. Alcuni formati dei les contengono l'encoding information, agevolando le
               attività del software che li elabora; sarà suf ciente poi aprire quei les e salvarli di nuovo,
               speci cando la codi ca UTF-8. In altri casi, sarà necessario speci carne la codi ca originale
               (ISO-8859-1 o "Western", oppure ISO-8859-15 o "Western (Euro)" a seconda delle formulazioni)
               all'apertura del le.

               Per i semplici les di testo, potrete utilizzare recode (contenuto nell'omonimo pacchetto), che
               consente la ricodi ca automatica. Questo strumento ha molteplici opzioni che consentono di giocare
               con il suo funzionamento. Vi invitiamo a consultare la sua documentazione, la recode (1) man page
               o la recode info page (più completa).




               8.2. Come con gurare la rete



                       BASILARE                                        La maggior parte delle moderne reti locali utilizzano il protocollo Ethernet, in cui i
                Rete: concetti                                         dati sono suddivisi in blocchi chiamati frames e sono trasmessi sul cavo un frame
                                                                       alla volta. La velocità della trasmissione dei dati varia da 10 Mbit/s per le schede
                essenziali
                                                                       Ethernet più vecchie, a 10 Gbit/s per le schede di generazione più recente (al
                (Ethernet,                                             momento della stesura di questo testo il valore più frequente si aggira dai 100 Mbits
                indirizzo IP,                                          a 1 Gb/s). I cavi più comuni sono chiamati in base alla capacità che possano
                subnet -                                               supportare in modo af dabile (la T sta per “twisted pair” o doppino): 10BASE-T,
                sottorete,                                             100BASE-T, 1000BASE-T o 10GBASE-T; ciascuno di questi cavi è dotato di un
                                                                       connettore RJ45. Esistono altri tipi di cavi, che vengono utilizzati principalmente
                broadcast ...)
                                                                       per la velocità di trasmissione dati da 1 Gbit/s in su.
                                                                       Un indirizzo IP è un numero utilizzato per identi care un’interfaccia di rete su un
                                                                       computer di una rete locale o su Internet. Nella versione attualmente più recente di
                                                                       IP (IPv4), questo numero è codi cato a 32 bits ed è generalmente rappresentato con
                                                                       4 numeri separati da punti (es: 192.168.0.1), ogni numero può variare da 0 a 255
                                                                       (255 incluso, che corrisponde a 8 bit di dati). La versione susseguente del suddetto
                                                                       protocollo, il protocollo IPv6, estende “l’address space” [“l’address space” è un
                                                                       intervallo di indirizzi discreti, ciascuno dei quali può corrispondere ad un host di
                                                                       rete, un dispositivo periferico, un settore del disco, una cella di memoria o un’altra
                                                                       entità logica o sica] a 128 bits, e gli indirizzi sono rappresentati come numeri
                                                                       esadecimali separati da due punti (es:
                                                                       2001:0db8:13bb:0002:0000:0000:0000:0020, che può essere abbreviato in
                                                                       2001:db8:13bb:2::20).
                                                                       Una maschera di sottorete (subnet mask - netmask) de nisce attraverso la sua
                                                                       stessa codi ca binaria quale parte di un indirizzo IP corrisponde alla rete, mentre la
                                                                       parte rimanente speci ca l’identi catore della macchina.




                                                                                  TDAH_1.0                      Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 149
fi
      

          fi
                fi
                     fi
                     fi
                          fi
                               fi
                                     

                                     

                                         fi
                                              fi
                                                   fi
                                                   fi
                                                   fi
                                                        fi
                                                             fi
                                                                  fi
                                                                              

                                                                                  fi
                                                                                       fi
                                                                                             

                                                                                             

                                                                                                  

                                                                                                      fi
                                                                                                           fi
                                                                                                                    

                                                                                                                               fi
                                                                                                                                    fi
                                                                                                                                          

                                                                                                                                               

                                                                                                                                               

                                                                                                                                                   fi
                                                                                                                                                                  

                                             Ad esempio per la con gurazione di una data IPv4 statica, la maschera di sottorete
                                             255.255.255.0 (ventiquattro “1” seguiti da otto “0” in rappresentazione binaria)
                                             indica che i primi 24 bit dell’indirizzo IP corrispondono all’indirizzo di rete, mentre
                                             gli ultimi 8 appartengono al numero della macchina. In IPv6, per motivi di
                                             leggibilità, è espresso solo con un numero composto da “1”. Di conseguenza una
                                             maschera di rete IPv6 è di 64 bit.
                                             L’indirizzo di rete è un indirizzo IP la cui parte che descrive il numero della
                                             macchina è zero. L’intervallo di indirizzi IPV4 di un’intera rete è spesso descritto
                                             dalla sintassi a.b.c.d/e dove a.b.c.d è l’indirizzo di rete ed e il numero di bit
                                             assegnato al ruolo (nella rete) in un indirizzo IP. Un indirizzo di rete ad esempio
                                             potrebbe quindi essere: 192.168.0.0/24. La sintassi è simile con il protocollo IPv6:
                                             2001:db8:13bb:2::/64.
                                             Un router è una macchina che collega diverse reti insieme. Tutto il traf co che
                                             arriva attraverso il router viene reindirizzato alla rete corretta. Per fare ciò, il
                                             router analizza i pacchetti in arrivo e li reindirizza in base all’indirizzo IP della loro
                                             destinazione. Il router viene spesso de nito gateway e funziona come una macchina
                                             che consente di uscire da una rete locale (verso un extended network come lo
                                             stesso Internet).
                                             Lo special broadcast address [La IETF e la IANA hanno limitato dall’uso generale
                                             vari indirizzi IP riservati a scopi speciali tra cui il broadcast address] consente di
                                             raggiungere tutte le stazioni di rete. Quasi mai “routed”, tale indirizzo funziona solo
                                             sulla rete in questione. Concretamente, ciò signi ca che un pacchetto dati
                                             indirizzato ad un indirizzo broadcast non oltrepasserà mai un router.
                                             Si precisa che in questo capitolo vengono trattati gli indirizzi IPv4, più
                                             comunemente utilizzati al momento della stesura di questo testo. Il protocollo IPv6
                                             sarà discusso dettagliatamente nel paragrafo 10.5, “IPv6” a pagina 237, ma i
                                             concetti essenziali rimangono gli stessi.


          Dal momento che la rete viene impostata automaticamente durante l'installazione iniziale, il le /
          etc/network/interfaces contiene già una con gurazione valida. Una riga che inizia con auto
          fornisce l'elenco di interfacce che saranno con gurate automaticamente all'avvio da ifupdown e dal
          suo script init /etc/init.d/networking. Spesso la prima scheda Ethernet è indicata con eth0.


             ALTERNATIVA                     Il Network Manager è particolarmente indicato per le con gurazioni roaming
           NetworkManager                    (andate a leggere il paragrafo 8.2.4, “Con gurazione della rete automatica per i
                                             Roaming Users” a pagina 153), ma può essere utilizzato anche come strumento
                                             prede nito per la gestione della rete. Potrete realizzare delle “System connections”,
                                             che vengono attivate all’avvio del computer, creando manualmente un le .ini-
                                             like in /etc/NetworkManager/system-connections/, o tramite uno strumento
                                             gra co (nm-connection-editor). Dovrete solo ricordare di disabilitare tutte le
                                             voci in /etc/network/interfaces af nché Network Manager si occupi delle
                                             suddette interfacce.
                                                https://wiki.gnome.org/Projects/NetworkManager/SystemSettings/jessie
                                                https://developer.gnome.org/NetworkManager/0.9/ref-settings.html




          8.2.1 Interfaccia Ethernet

          Se il computer ha una scheda di rete Ethernet, è necessario con gurare la rete IP ad essa associata
          attraverso uno dei seguenti (due) metodi. Il più semplice dei due metodi è la con gurazione dinamica
          tramite DHCP, che richiede la presenza di un server DHCP sulla rete locale.




          Pagina 150 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
                  fi
                                   fi
                                        fi
                                              fi
                                                     fi
                                                          fi
                                                               fi
                                                                    fi
                                                                             fi
                                                                              fi
                                                                                  fi
                                                                                                 fi
                                                                                                                fi
                                                                                                                      

                                                                                                                           

                                                                                                                                

          Potrete indicare un nome host a piacere, che corrisponde al parametro opzionale hostname
          nell'esempio sottostante. Il server DHCP quindi vi restituirà i parametri di con gurazione di rete
          appropriati.

                                                                                        Esempio 8.1 Con gurazione DHCP
          auto eth0
          iface eth0 inet dhcp
            hostname arrakis

          Per una con gurazione "statica" dovrete indicare i parametri di rete in modo statico. Per fare ciò
          dovrete includere almeno l'indirizzo IP e la maschera di sottorete; a volte nell'elenco della
          con gurazione statica sono inclusi anche il network address ed il broadcast address. Un router che
          consente delle connessioni al di fuori della rete verrà menzionato come gateway.

                                                                                       Esempio 8.2 Con gurazione Statica

          auto eth0
          iface eth0 inet static
            address 192.168.0.3
            netmask 255.255.255.0
            broadcast 192.168.0.255
            network 192.168.0.0
            gateway 192.168.0.1



                           NOTA                                            È possibile non solo associare più interfacce ad una singola scheda di rete sica, ma
               Indirizzi multipli                                          anche diversi indirizzi IP ad una singola interfaccia. Inoltre si precisa che un
                                                                           indirizzo IP può corrispondere tramite DNS a diversi nomi e che un nome può a sua
                                                                           volta corrispondere a diversi indirizzi IP numerici.
                                                                           Comprenderete che le con gurazioni possono essere molto complesse, ma le
                                                                           summenzionate opzioni vengono utilizzate solo in casi molto speci ci. Gli esempi
                                                                           citati qui riguardano solo le con gurazioni ordinarie.



          8.2.2 La connessione PPP tramite modem PSTN

          Una connessione point to point (PPP) stabilisce una intermittent connection; questa soluzione è la
          più diffusa per le connessioni con modem-telefono (tale tipo di modem viene de nito "modem PSTN",
          dal momento che la connessione avviene tramite la Public Switched Telephone Network o
          Rete Telefonica Generale - RTG o Rete Telefonica Pubblica Commutata - PSTN).

          Una connessione tramite modem-telefono richiede un account con un access provider ed inoltre un
          numero di telefono, un nome utente, una password e, talvolta, un authentication protocol. Essendo di
          fatto una connessione viene con gurata attraverso un tool, il pppconfig , che è incluso
          nell'omonimo pacchetto Debian.

          Per impostazione prede nita, viene con gurato un "connection name" (che corrisponde a quello
          dell'Internet service provider). In caso di dubbi sull'authentication protocol, selezionare PAP
          [Password Authentication Protocol]: è supportato dalla maggior parte degli Internet service
          providers.




                                                                                    TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 151
fi
      

      

          fi
                fi
                fi
                         fi
                              fi
                                   fi
                                         

                                              

                                              

                                                   

                                                       fi
                                                             

                                                                  

                                                                      fi
                                                                               fi
                                                                                                       fi
                                                                                                                fi
                                                                                                                               fi
                                                                                                                                    fi
                         Dopo la con gurazione, è possibile connettersi utilizzando il comando pon (seguito, sotto forma di
                         parametro, dal nome della connessione qualora il valore prede nito provider non sia idoneo). Per
                         chiudere la connessione utilizzate il comando poff. Questi due comandi possono essere eseguiti
                         dall'utente root o da qualsiasi altro utente, che faccia parte del gruppo dip.


                         8.2.3 La connessione tramite modem ADSL

                         Il termine generico "modem ADSL" indica svariati devices con funzioni diverse fra loro. I modems più
                         semplici da usare con Linux sono quelli che hanno un'interfaccia Ethernet (e non solo un'interfaccia
                         USB). Quest'ultimi si stanno diffondendo considerevolmente; la maggior parte degli ADSL Internet
                         service providers prestano (o noleggiano) un "box" con interfacce Ethernet. A seconda del tipo di
                         modem, la con gurazione richiesta può variare notevolmente.


                         8.2.3.1 I Modems che supportano PPPOE

                         Alcuni modem Ethernet funzionano con il protocollo PPPOE (Point to Point Protocol over Ethernet).
                         Il tool pppoeconf (che deriva dal pacchetto omonimo) sarà in grado di con gurare la connessione.
                         Per fare ciò, modi cherà il le /etc/ppp/peers/dsl-provider con i parametri supportati e salverà
                         i dati per il login nei les /etc/ppp/pap-secrets e /etc/ppp/chap-secrets. Vi raccomandiamo
                         di accettare tutte le modi che che vi propone.

                         Quando avrete ultimato questa con gurazione, potrete avviare la connessione ADSL con il comando
                         pon dsl-provider ed interromperla con il comando poff dsl-provider.




                               SUGGERIMENTO                                                Le connessioni PPP tramite ADSL sono, per de nizione, intermittenti. Dato che tali
                              Come eseguire                                                connessioni non sono fatturate a consumo e che ci sono pochi aspetti negativi
                              ppp all’avvio del                                            nell’appro ttarne, sarete tentati a mantenere sempre aperta la connessione; un
                                                                                           metodo semplice per fare quanto sopra espresso è utilizzare il processo init.
                              computer
                                                                                           Il sistema prede nito init di Jessie è systemd. Per aggiungere una task che riavvi
                                                                                           automaticamente la connessione ADSL, è suf ciente creare, un “ le unit”, [systemd
                                                                                           salva le istruzioni di inizializzazione di ciascun demone in un correlato le di
                                                                                           con gurazione, denominato “ le unit”], come ad esempio /etc/systemd/system/
                                                                                           adsl-connection.service con un contenuto simile al seguente:

                                                                                           [Unit
                                                                                           Description=ADSL connectio

                                                                                           [Service
                                                                                           Type=forkin
                                                                                           ExecStart=/usr/sbin/pppd call dsl-provide
                                                                                           Restart=alway

                                                                                           [Install
                                                                                           WantedBy=multi-user.targe

                                                                                           Una volta che avrete con gurato il le unit, dovrete abilitarlo con il comando
                                                                                           systemctl enable adsl-connection. Dopodiché potrete avviare il loop [“loop” in
                                                                                           inglese signi ca letteralmente “ciclo continuo”] con il comando systemctl start
                                                                                           adsl-connection; così facendo tale processo si avvierà automaticamente durante
                                                                                           il boot.




                         Pagina 152 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     ]

          ]

          ]

          fi
               fi
                    fi
                         g

                               fi
                               fi
                                    s

                                         fi
                                              fi
                                                   fi
                                                        fi
                                                             fi
                                                                  fi
                                                                       t

                                                                            n

                                                                                 fi
                                                                                      fi
                                                                                               fi
                                                                                                    fi
                                                                                                         r

                                                                                                                   fi
                                                                                                                        fi
                                                                                                                             fi
                                                                                                                                     fi
                                  Sui sistemi che non usano systemd (inclusi quelli che eseguono Wheezy o altre
                                  versioni antecedenti di Debian), il processo prede nito SystemV funziona in modo
                                  diverso. Su tali sistemi, dovrete semplicemente aggiungere la seguente riga alla ne
                                  del contenuto del le /etc/inittab; in questo modo tutte le volte che la
                                  connessione dovesse interrompersi il processo init la riavvierà.

                                  adsl:2345:respawn:/usr/sbin/pppd call dsl-provide

                                  Per le connessioni ADSL che subiscono una disconnessione automatica al giorno,
                                  questo metodo consente di ridurre la durata dell’interruzione.


          8.2.3.2 I Modems che supportano PPTP

          Il protocollo Point-to-Point Tunneling Protocol (PPTP) fu creato dalla Microsoft. Fu distribuito agli
          esordi dell'ADSL ed è stato poi rapidamente sostituito dal PPPOE. Qualora foste costretti ad utilizzare
          questo protocollo, andate a leggere il paragrafo 10.2.4, "PPTP" a pagina 231.


          8.2.3.3 I Modems che supportano DHCP

          Quando un modem è collegato al computer con un cavo Ethernet (un cavo crossover), potrete
          con gurare sul suddetto computer la classica connessione di rete via DHCP; il modem funzionerà
          automaticamente come un gateway per impostazione prede nita e si occuperà del routing (ovvero
          della gestione del traf co di rete fra il computer e Internet). [Un cavo crossover è un tipo cavo che
          consente a due computer o due device di pari livello di essere collegati e di potersi scambiare dati
          reciprocamente].



                      BASILARE    Le schede di rete dei computers supportano la ricezione dei dati su degli speci ci li
               Cavi crossover     del cavo e trasmettono i loro dati attraverso gli altri.
                                  Quando connettete un computer ad una rete locale, solitamente collegate un cavo
               per una            (straight o crossover) tra la scheda di rete ed un ripetitore o uno switch. Tuttavia,
               connessione        se desiderate collegare direttamente due computer (vale a dire senza uno switch o
               diretta via        un ripetitore intermedio), dovrete instradare il segnale dalla sezione trasmittente
               Ethernet           di una scheda alla sezione ricevente dell’altra e viceversa. Al summenzionato
                                  servizio ci pensa il cavo crossover, che è per l’appunto impiegato per tale ragione.
                                  Si precisa che la suddetta distinzione è irrilevante, dato che le moderne schede di
                                  rete sono in grado di rilevare automaticamente il tipo di cavo utilizzato e di
                                  adattarsi di conseguenza; pertanto non è raro che entrambi i tipi di cavo funzionano
                                  in modo identico nella medesima ubicazione.


          La maggior parte dei "routers ADSL" sul mercato funziona in questo modo, così come la maggior
          parte dei modems ADSL concessi dai fornitori di servizi Internet.


          8.2.4. Con gurazione della rete automatica per i Roaming Users

          Molti ingegneri della Falcot hanno un computer laptop che usano sia per scopi professionali, sia a
          casa. La con gurazione di rete da utilizzare differisce in base all'ubicazione. A casa, potrebbe essere
          una rete Wi-Fi (protetta da una chiave WPA), mentre al lavoro potrebbe essere una rete cablata che
          offre maggiore sicurezza e maggiore velocità.




                                         TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 153
fi
     fi
          fi
                 fi
                      fi
                           fi
                                           fi
                                                        r

                                                             fi
                                                                         fi
                                                                              fi
                                                                                   fi
                Per evitare di dover attivare o disattivare manualmente le interfacce di rete correlate, gli
                amministratori hanno installato il pacchetto network-manager sulle suddette macchine roaming.
                Questo software consente all'utente di effettuare facilmente lo switch da una rete all'altra utilizzando
                una piccola icona dell'area di noti ca del loro ambiente desktop. Un clic sull'icona attiva la
                visualizzazione di un elenco di reti disponibili (cablate e Wi-Fi), di conseguenza gli amministratori
                dovranno soltanto scegliere la rete da utilizzare. Il programma salva le reti in cui l'utente ha già
                effettuato l'accesso e passa automaticamente alla migliore rete disponibile quando perde la
                connessione in corso.

                A tale scopo, il programma è strutturato in due parti: un demone in esecuzione con permessi di root
                esegue le operazioni di attivazione e con gurazione delle interfacce di rete mentre un'interfaccia
                utente controlla a sua volta questo demone. PolicyKit gestisce le autorizzazioni necessarie per
                controllare questo programma; Debian ha con gurato PolicyKit in modo che solo i membri del
                gruppo netdev abbiano i permessi per creare o modi care le connessioni di Network Manager.

                Network Manager in questo modo potrà gestire diversi tipi di connessione (DHCP, con gurazione
                manuale, rete locale), ma a patto che la con gurazione sia stata eseguita suo tramite. Questo è il
                motivo per cui ignorerà sistematicamente tutte le interfacce di rete in /etc/network/interfaces
                non soddisfacenti. Dal momento che Network Manager non fornisce dettagli riguardo ad
                un'eventuale assenza di rete disponibili, il modo più semplice per risolvere qualsiasi avversità è
                rimuovere da /etc/network/interfaces le eventuali con gurazioni di tutte le interfacce di rete
                che devono essere gestite dallo stesso Network Manager.

                Si precisa che questo programma viene installato per impostazione prede nita durante
                l'installazione iniziale come effetto della selezione della task denominata "Desktop Environment".




                    ALTERNATIVA                   Gli utenti più esperti possono anche prendere in considerazione di provare il
                 Con gurazione                    pacchetto guessnet per la con gurazione automatica della rete. Una serie di “test
                 del “pro lo di                   scripts” determina il pro lo di rete da attivare e lo con gura immediatamente.
                                                  Gli utenti che preferiscono selezionare manualmente un pro lo di rete useranno
                 rete”
                                                  invece netenv, disponibile nell’omonimo pacchetto.



                8.3 Assegnazione dell’Hostname e Con gurazione del Name Service

                Lo scopo dell'assegnazione dei nomi ai numeri IP è di renderli facili da memorizzare per gli esseri
                umani. In realtà, un indirizzo IP identi ca un'interfaccia di rete correlata ad un dispositivo come ad
                esempio una scheda di rete. Dato che ciascuna macchina può avere diverse schede di rete, e diverse
                interfacce su ciascuna scheda, ogni singolo computer può avere a sua volta diversi nomi nel domain
                name system - DNS [Il Domain Name System - DNS (o sistema dei nomi di dominio in italiano) è un
                sistema utilizzato per assegnare i nomi agli hosts (o nodi della rete in italiano)].

                Ogni macchina è comunque identi cata da un prenome (o "main name" o "canonical"), conservato
                nel le /etc/hostname e comunicato al kernel Linux dagli scripts di inizializzazione attraverso il
                comando hostname. Il "valore corrente" corrispondente all'hostname è disponibile in un virtual
                 lesystem e potrete reperirlo attraverso il comando cat /proc/sys/kernel/hostname.

                Sorprendentemente, il nome di dominio non è gestito allo stesso modo, ma deriva dal nome completo
                della macchina, ottenuto attraverso la name resolution. Potrete modi carlo nel le /etc/hosts; vi
                basterà inserire un nome completo per la macchina all'inizio dell'elenco dei nomi associati agli
                indirizzi della macchina come da esempio seguente:




                Pagina 154 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
      fi
           fi
                           fi
                                 fi
                                        fi
                                             fi
                                                    fi
                                                         fi
                                                              fi
                                                                   fi
                                                                        fi
                                                                             fi
                                                                                  fi
                                                                                       fi
                                                                                            fi
                                                                                                 fi
                                                                                                      fi
                                                                                                           fi
                                                                                                                fi
               127.0.0.1 localhost
               192.168.0.1 arrakis.falcot.com arrakis




                           BASILARE                                  Gli alberi (o le strutture ad albero) dei les /proc/ e /sys/ sono generati dai le
                    /proc/ e /sys/,                                  systems “virtuali”. Questo metodo è pratico per recuperare informazioni del kernel
                                                                     (attraverso l’elenco dei les virtuali) e comunicarle allo stesso kernel (attraverso la
                     lesystem                                        redazione di les virtuali).
                    virtuali                                         /sys/ in particolare consente l’accesso agli internal kernel objects, specialmente a
                                                                     quelli che rappresentano le varie periferiche del sistema. Il kernel in questo modo
                                                                     può condividere diversi tipi di informazione: lo stato di ciascun dispositivo (ad
                                                                     esempio, se è in modalità di risparmio energetico), se è rimovibile, ecc. Si precisa
                                                                     che /sys/ è nato ed è stato reso disponibile a partire dalla versione 2.6. del kernel.


               8.3.1. Risoluzione dei nomi

               Il sistema di risoluzione dei nomi di Linux è modulare e può fare af damento su diverse sorgenti di
               informazione dichiarate nel le /etc/nsswitch.conf. La voce inerente alla risoluzione del nome
               dell'host è hosts. Per impostazione prede nita, quest'ultima voce elenca come servizi files e dns, il
               che signi ca che il sistema [seguendo l'ordine con cui sono stati elencati i servizi] consulta prima il
                 le /etc/hosts e poi interroga i server DNS. I servers NIS/NIS+ o LDAP sono altre possibili sorgenti.


                                               NOTA                  Fate attenzione, i comandi destinati speci catamente per il query DNS
                    NSS e DNS                                        (specialmente host) non usano lo standard name resolution mechanism (NSS).
                                                                     Pertanto non tengono conto del le /etc/nsswitch.conf, per non parlare di /etc/
                                                                     hosts.


               8.3.1.1 Con gurazione del server DNS

               [In generale il mapping è una tecnica di gestione dei dati (per poter eseguire una migrazione,
               integrazione, ecc), che consente l’estrazione dei dati dei campi (in inglese fields) di un database ed
               il loro indirizzamento ai campi corrispondenti di altri database targets. Pertanto, genericamente, i
               databases i cui dati vengono fra loro indirizzati attraverso questa tecnica possono essere de niti
               mapping databases]

               Il DNS (Domain Name Service) è un servizio (distribuito e gerarchico) che si occupa del mapping
               dei nomi di dominio associati agli indirizzi IP e viceversa. In pratica è in grado di associare un nome
               facile da ricordare per gli esseri umani come www.eyrolles.com ad un concreto indirizzo IP come
               ad esempio 213.244.11.247.

               Per accedere alle informazioni DNS, è necessario disporre di un server DNS che trasmetta le
               richieste. Anche se la Falcot Corp possiede un server DNS, generalmente un utente-tipo è più
               propenso ad usufruire dei servers DNS offerti dal suo ISP.

               I servers DNS che verranno utilizzati sono speci cati nel le /etc/resolv.conf ed elencati uno per
               riga, attraverso l'impiego della parola chiave nameserver che precede l'indirizzo IP, come mostrato
               nell'esempio seguente:

               nameserver 212.27.32.176
               nameserver 212.27.32.177
               nameserver 8.8.8.8

               Si precisa che il le /etc/resolv.conf potrebbe essere stato con gurato automaticamente (e
               sovrascritto) se la rete è gestita da NetworkManager o è stata con gurata attraverso DHCP.




                                                                                TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 155
fi
fi
     fi
          fi
               fi
                      fi
                           fi
                                 

                                      

                                          fi
                                                 fi
                                                      fi
                                                            

                                                            

                                                                fi
                                                                      fi
                                                                           fi
                                                                                     fi
                                                                                                 fi
                                                                                                      fi
                                                                                                           fi
                                                                                                                fi
                                                                                                                     fi
                                                                                                                                            fi
                     8.3.1.2 I1 le /etc/hosts

                     Anche in assenza di un name server nella rete locale, potrete comunque de nire una breve table che
                     si occupa del mapping tra gli indirizzi IP e gli hostnames nel le /etc/hosts, di solito quest'ultimo
                     riservato alle local network stations. La sintassi di questo le è molto semplice: ogni riga indica uno
                     speci co indirizzo IP seguito dall'elenco di tutti i nomi ad esso associati (il primo nome host è
                     "completely quali ed", ovvero include il nome di dominio).
                     Questo le è disponibile sia quando la rete è fuori servizio, sia quando i server DNS sono
                     irraggiungibili, ma potrà esservi davvero utile solo se lo duplicherete su tutti i computers della rete.
                     Qualsiasi cambiamento minimo di questo le ne comporterà il suo aggiornamento obbligatorio su
                     tutte le macchine della rete. Per questo motivo il le /etc/hosts di solito contiene solo le voci più
                     importanti.
                     Per una piccola rete non connessa ad Internet questo le sarà suf ciente, ma da cinque macchine in
                     sù si consiglia di installare un server DNS adeguato.


                       SUGGERIMENTO                                                 Poiché le applicazioni consultano il le /etc/hosts prima di interrogare (“querying”)
                      Come scavalcare                                               il DNS, è possibile inserire informazioni diverse rispetto a quelle che normalmente il
                                                                                    DNS restituirebbe, scavalcando di fatto il normale sistema “DNS-based name
                      il DNS                                                        resolution”.
                                                                                    Quanto sopra espresso vi consente, qualora le modi che del DNS non siano state
                                                                                    ancora “propagate”, di testare l’accesso ad un sito Web con il nome previsto anche
                                                                                    se non è ancora associato all’indirizzo IP corretto.
                                                                                    Inoltre, sempre secondo quanto sopra espresso, potrete escludere qualsiasi
                                                                                    comunicazione con un host reindirizzando il traf co a questi destinato verso la
                                                                                    localhost. Ad esempio potrete applicare tale misura agli hostnames dei servers
                                                                                    dedicati al servizio ads [ovvero all’invio dei banner pubblicitari], rendendo la
                                                                                    navigazione più uida e meno distraente dal momento che i loro annunci non
                                                                                    potranno più essere caricati.




                     8.4. Database utenti e gruppi

                     L'elenco utenti si trova generalmente nel le /etc/passwd, mentre il le /etc/shadow contiene le
                     password crittografate. Entrambi sono le di testo, in un formato relativamente semplice, che
                     possono essere letti e modi cati con un editor di testo. Ogni utente è descritto su una riga con diversi
                     campi separati dai due punti (“:”).




                                   NOTA                                             I les di sistema menzionati in questo capitolo sono in formato “testo puro” e
                      Come modi care                                                possono quindi essere modi cati con un editor di testo. Data la loro importanza per
                                                                                    le funzionalità essenziali del sistema, vi raccomandiamo di adottare precauzioni
                      i les di sistema                                              extra prima di qualsiasi modi ca ai les di sistema. Innanzitutto effettuate sempre
                                                                                    il backup o una copia dei les di sistema prima del loro opening o alterazione.
                                                                                    Inoltre sui servers o su macchine dove più persone possono potenzialmente
                                                                                    accedere allo stesso le contemporaneamente prendete ulteriori misure per
                                                                                    prevenire che il le venga corrotto.
                                                                                    Per fare ciò, potrete utilizzare il comando vipw per modi care /etc/passwd o vigr
                                                                                    per /etc/group. Questi comandi bloccheranno il le in questione in modo che non
                                                                                    possa essere eseguito un editor di testo (vi per impostazione prede nita, a meno
                                                                                    che non sia stata modi cata la variabile di ambiente EDITOR). L’opzione -s di questi
                                                                                    comandi consente di modi care il le shadow corrispondente.




                     Pagina 156 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
fi
     fi
          fi
               fi
                fi
                        fi
                        fl
                             fi
                                  fi
                                       fi
                                            fi
                                                 fi
                                                      fi
                                                           fi
                                                                fi
                                                                     fi
                                                                          fi
                                                                               fi
                                                                                       fi
                                                                                            fi
                                                                                            fi
                                                                                                 fi
                                                                                                      fi
                                                                                                           fi
                                                                                                                fi
                                                                                                                     fi
                                                                                                                          fi
                                                                                                                               fi
                                                                                                                                    fi
                                                                                                                                    fi
                                                                                                                                         fi
                                                                                                                                              fi
                                                                                                                                                   fi
                                     BASILARE               crypt, è una “funzione unidirezionale” che trasforma una stringa (A) in un’altra
                              Crypt, una                    stringa (B) in modo che da B non si possa risalire ad A. L’unico modo per
                                                            identi care A è quello di testare tutti i potenziali valori corrispondenti,
                              funzione a senso
                                                            veri candone individualmente l’avvenuta trasformazione attraverso la funzione
                              unico                         con il risultato concreto della stessa funzione ovvero B. Crypt utilizza no a 8
                                                            caratteri come input (stringa A) e genera una stringa di 13 caratteri ASCII
                                                            printable [tradotto letteralmente “stampabili”] (stringa B).



                    8.4.1. Elenco degli utenti: /etc/passwd

                    Questa è la lista dei campi del le /etc/passwd:
                    • login, ad esempio hertzog;
                    • password: è una password crittografata dalla funzione unidirezionale (crypt), che sfrutta DES,
                    MD5, SHA-256 o SHA-512. Il valore speciale "x" indica che la password crittografata è conservata
                    in /etc/shadow;
                    • uid: numero univoco che identi ca ciascun utente;
                    • gid: numero univoco del gruppo principale dell'utente (Debian crea di default un gruppo speci co
                    per ciascuno utente);
                    • GECOS: campo informativo che di solito contiene il nome completo dell'utente;
                    • login directory, assegnata all'utente per conservare i suoi les personali (la variabile d'ambiente
                    $HOME di solito punta a questa directory);
                    • program to execute upon login. [programma da eseguire dopo il login.] È generalmente un
                    interprete dei comandi (shell), che conferisce all'utente molta libertà. Se si speci ca /bin/false (non
                    viene eseguito alcun programma e non viene concesso alcun controllo), l'utente non sarà in grado di
                    eseguire il login.

                                       BASILARE              Un gruppo Unix è un’entità [in breve “un’entità” in informatica è una Primitive
                              Unix Group                     Data Type ovvero non letteralmente un blocco di dati essenziale che comunica
                                                             all’interprete dei comandi come utilizzare i dati] che include diversi utenti in modo
                                                             che possano facilmente condividere les utilizzando l’integrated permission
                                                             system (bene ciando degli stessi diritti). Potrete anche limitare l’uso di
                                                             determinati programmi ad un determinato gruppo.




                    8.4.2. Il le /etc/shadow, criptato e nascosto

                    Il le /etc/shadow contiene i seguenti campi:
                    • login;
                    • encrypted password (password crittografata);
                    • diversi campi si occupano della scadenza della password.


                               DOCUMENTAZIONE                Questi formati sono documentati nelle seguenti man pages: passwd(5), shadow(5),
                              I formati dei les /            group(5).
                              etc/passwd, /etc/
                              shadow e /etc/group




                                                                   TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 157
fi
     fi
          fi
               fi
                    fi
                         fi
                                        fi
                                             fi
                                                  fi
                                                       fi
                                                                                       fi
                                                                                            fi
                                                                                                                fi
                                                                                                                                   fi
                    SICUREZZA                          /etc/shadow, a differenza della sua alternativa /etc/passwd, è inaccessibile alla
           La protezione                               lettura degli utenti regolari. Qualsiasi password crittografata conservata in
                                                       /etc/passwd è leggibile da chiunque; quindi un cracker potrebbe provare a
           applicata al le                             “rompere” la crittogra a (e poi eventualmente rivelarla pubblicamente)
           /etc/shadow                                 attraverso uno dei diversi attacchi con metodo “forza bruta”, che mettono
                                                       semplicemente insieme le combinazioni di caratteri maggiormente utilizzate.
                                                       Questo tipo di attacco è chiamato “a dizionario”, ma non è più applicabile sui
                                                       sistemi che adottano il le /etc/shadow.


     8.4.3. Modi ca un account o una password esistenti

     I seguenti comandi consentono la modi ca delle informazioni conservate nei correlati campi del
     database utente: passwd consente agli utenti regolari di cambiare la propria password, aggiornando
     in pratica il le /etc/shadow; chfn (CHange Full Name), riservato al super-user (root), modi ca il
     campo GECOS; chsh (CHange SHell) consente agli utenti di cambiare la loro login shell, o shell, ma
     limitatamente fra quelle elencate nel le /etc/shells; diversamente l'amministratore non è
     limitato da questa restrizione e può impostare qualunque programma-shell desideri.
     In ne, il comando chage (CHange AGE) consente all'amministratore di modi care i parametri della
     scadenza della password-utente (l'opzione -l user consente la visualizzazione della con gurazione
     corrente). Potrete anche forzare la scadenza della password-utente usando il comando passwd -e
     user, che costringerà l'utente coinvolto dal suddetto comando a cambiare la sua password durante il
     successivo login.


     8.4.4. Come bloccare un account

     Potreste essere costretti a "bloccare l'account" di un utente, come misura disciplinare, nell'ambito di
     un'indagine o semplicemente nei casi di prolungato o permanente inutilizzo del suddetto account da
     parte dell'utente. L'effetto di un account disabilitato è che l'utente correlato non può più identi carsi
     attraverso il login o accedere alla macchina. L'account rimane intatto sulla macchina ed i suoi les o
     dati non vengono cancellati; è semplicemente non utilizzabile. Ciò è realizzabile attraverso il
     comando utente passwd -1 user (da "lock” che signi ca in inglese bloccare). L'account può essere
     nuovamente abilitato attraverso un metodo simile, ovvero con l'opzione -u (da "unlock" che signi ca
     in inglese sbloccare).




              ANDANDO OLTRE                            Invece di utilizzare i soliti les per gestire gli elenchi di utenti e gruppi, potrete
           Database di sistema                         ricorrere ad altri tipi di database - come ad esempio LDAP o db - utilizzando un
                                                       appropriato modulo NSS (Name Service Switch o service multiplexer). I moduli
           e NSS
                                                       utilizzati sono elencati nel le /etc/nsswitch.conf sotto le voci passwd, shadow e
                                                       group. Andate a leggere il paragrafo 11.7.3.1 “Come con gurare l’NSS” a pagina
                                                       287 per avere un esempio concreto sull’uso del modulo NSS attraverso LDAP.



     8.4.5. Elenco dei gruppi: /etc/group

     L'elenco dei gruppi è memorizzato nel le /etc/group, un semplice database testuale in un formato
     simile a quello del le /etc/passwd, che utilizza i seguenti campi:

     • group name (identi catore o il nome del gruppo);




     Pagina 158 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
     fi
      fi
               fi
                    fi
                         fi
                              fi
                                   fi
                                        fi
                                             fi
                                                  fi
                                                       fi
                                                                    fi
                                                                         fi
                                                                                                   fi
                                                                                                                  fi
                                                                                                                       fi
                                                                                                                            fi
                                                                                                                                 fi
                                                                                                                                      fi
                                                                                                                                            

     • password (opzionale): viene utilizzata per "associarsi" ad un gruppo quando non si è membri
     abituali (attraverso il comando newgrp o sg - andate a leggere la casella di testo “Come lavorare con
     più gruppi” a pagina 159);
     • gid: numero univoco che identi ca il gruppo;
     • list of members (l'elenco dei membri): l'elenco dei nomi degli utenti appartenenti al gruppo,
     separati da virgole.


                   BASILARE                          Qualsiasi utente può quindi far parte di più gruppi; fra questi vi è il “main group”
          Come lavorare con                          (gruppo principale). Il “main group” prede nito dell’utente viene impostato
                                                     durante la creazione dell’account utente.
          più gruppi                                 Per impostazione prede nita, ogni le creato dall’utente appartiene ai gruppi
                                                     correlati all’utente, nonché al main group. Ma non sempre questo è quello che si
                                                     desidera: ad esempio, qualora lavoriate in una directory condivisa attraverso un
                                                     altro gruppo diverso dal vostro main group. In questo caso, un utente potrebbe
                                                     avere l’interesse di cambiare temporaneamente il main group attraverso uno dei
                                                     seguenti comandi: newgrp - che avvia una nuova shell - o sg - che esegue
                                                     semplicemente un comando utilizzando un gruppo alternativo sostituto. Questi
                                                     comandi consentono inoltre ad un utente di unirsi ad un gruppo di cui non è
                                                     membro. Se il gruppo è protetto da una password nota occorrerà fornirla prima
                                                     di eseguire il comando.
                                                     In alternativa potete impostare il setgid bit sulla directory, in modo che i les
                                                     creati in questa directory appartengano automaticamente al gruppo giusto. Per
                                                     maggiori dettagli, andate a leggere la casella di testo “setgid directory e sticky
                                                     bit” a pagina 198.
                                                     Il comando id consente di veri care in qualsiasi momento lo stato degli utenti, il
                                                     loro identi cativo personale (variabile uid), il loro corrente main group
                                                     (variabile gid) e l’elenco dei gruppi di cui sono membri (variabile groups).



     I comandi addgroup e delgroup consentono rispettivamente di creare ed eliminare un gruppo. Il
     comando groupmod modi ca le informazioni di un gruppo (il suo gid o identi catore). Il comando
     passwd -g group cambia la password di un gruppo, mentre il comando passwd -r -g group la
     cancella.




             SUGGERIMENTO                            Il comando getent (get entries) consulta, nella modalità standard, i databases di
          getent                                     sistema utilizzando le funzioni della correlata libreria, che a turno chiamano i
                                                     moduli NSS con gurati nel le /etc/nsswitch.conf . Il suddetto comando
                                                     richiede uno o due argomenti: il nome del database da consultare ed una
                                                     potenziale parola chiave per la ricerca. Ad esempio, il comando getent passwd
                                                     rhertzog restituisce informazioni riguardo al database utente “dell’utente
                                                     rhertzog”.



     8.5. Creazione degli accounts

     Una delle prime azioni che un amministratore è costretto a compiere quando con gura una
     macchina è la creazione di un account utente. Un account utente è tipicamente realizzato attraverso
     il comando adduser, che necessita sotto le vesti di argomento di un nome-utente per il nuovo utente
     da creare.
     Il comando adduser pone alcune domande prima di creare l'account, ma il suo utilizzo è abbastanza
     semplice. Il le di con gurazione /etc/adduser.conf, include tutte le impostazioni riguardo alla
     creazione dell'utente: potrete quindi utilizzare questo le per fornire automaticamente un "quota"
     per ciascun nuovo utente attraverso la creazione di un "modello utente" o per cambiare la posizione
     degli accounts utente; quest'ultima possibilità, raramente impiegata, si dimostra ef cace per




                                                         TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 159
fi
     fi
          fi
                fi
                 fi
                      fi
                       fi
                            fi
                                 fi
                                      fi
                                           fi
                                                fi
                                                                      fi
                                                                                    fi
                                                                                                 fi
                                                                                                       fi
                                                                                                            fi
     esempio quando c'è un vasto numero di utenti e si desidera distribuire i loro accounts su più dischi.
     Potrete anche scegliere una differente shell prede nita.



                               BASILARE              Il termine “quota” si riferisce ad una limitazione delle risorse della macchina che
      Quota                                          un utente può utilizzare. Questo limite spesso riguarda lo spazio sul disco.



     La creazione dell'account crea la home directory dell'utente il cui contenuto deriva dal modello
     /etc/skel/. Così facendo l'utente viene provvisto delle directories e dei les standard.
     In alcuni casi, sarà utile aggiungere un utente ad un gruppo (diverso dal suo "main group"), in
     particolare per concedergli ulteriori diritti. Ad esempio, un utente incluso nel gruppo audio sarà in
     grado di accedere ai dispositivi audio (andate a leggere la casella di testo "Diritti di accesso ad un
     dispositivo" a pagina 160). Per aggiungere un utente ad un gruppo eseguite il comando adduser
     user group.



                  BASILARE                           Ogni dispositivo hardware è rappresentato nei sistemi Unix attraverso un
      Diritti di accesso ad                          cosiddetto “special les” [o le “device”], generalmente memorizzato
                                                     nell’albero /dev/(DEVices). Esistono due tipi di special les a seconda della
      un dispositivo
                                                     natura del dispositivo: i les in “character mode” ed i les in “block mode”;
                                                     ciascuna modalità consente solo un numero limitato di operazioni. Mentre la
                                                     “character mode” si limita alle interazioni con operazioni di lettura e scrittura,
                                                     la “block mode” consente anche la ricerca nei dati disponibili. In ne, ogni special
                                                       le è associato a due numeri (“major” e “minor”) che identi cano per il kernel in
                                                     modo univoco il dispositivo [il numero “major”, comune per tutti i dispositivi
                                                     controllati dallo stesso driver, identi ca per il kernel il tipo di dispositivo; il
                                                     numero “minor” invece identi ca per il driver le caratteristiche peculiari del
                                                     dispositivo in modo da renderle accessibili]. Tale le, creato attraverso il
                                                     comando mknod, ha semplicemente un nome simbolico (è più pratico per l’utente
                                                     “umano”). I permessi di uno special le rilevano i permessi per accedere al
                                                     dispositivo stesso. Pertanto, ad esempio, un le come /dev/mixer - ovvero il
                                                     mixer audio - è accessibile in modalità lettura/scrittura solo all’utente root ed ai
                                                     membri del gruppo audio. Di conseguenza solo questi utenti possono utilizzare
                                                     il mixer audio.
                                                     Si precisa però che la combinazione di udev, consolekit e policykit è in
                                                     grado di aggiungere ulteriori autorizzazioni per consentire agli utenti
                                                       sicamente connessi alla console (e non tramite la rete) di accedere ai diversi
                                                     dispositivi.



     8.6. Ambiente Shell

     Gli interpreti dei comandi (o shells), essendo delle potenziali prime forme di contatto dell'utente con
     il computer, dovrebbero essere piuttosto intuitive. La maggior parte usano gli scripts di
     inizializzazione che consentono la con gurazione del loro funzionamento (completamento
     automatico, prompt text, ecc.).
     bash, la shell prede nita, usa lo script di inizializzazione /etc/bash.bashrc (per le "interactive
     shells") e /etc/pro le (per i "login shells").




                BASILARE                             In poche parole, una login shell viene invocata quando accedete alla console
      Login shell e                                  tramite ssh o tramite il comando esplicito bash --login. Che si tratti di una
                                                     login shell o meno, una shell può essere interattiva (se si svolge ad esempio in un
      interactive shell (e
                                                     terminale xterm-type); oppure una shell non interattiva (quando sta
      non)                                           eseguendo uno script).




     Pagina 160 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
fi
           fi
                fi
                     fi
                          fi
                                fi
                                     fi
                                          fi
                                           fi
                                                fi
                                                     fi
                                                           fi
                                                                fi
                                                                     fi
                                                                          fi
                                                                               fi
                                                                                    fi
                                                                                            fi
                                                                                                                       

                  ESPLORANDO            Ogni interprete di comandi ha una sintassi speci ca e dei propri les di
           Altre shells, altri          con gurazione. Pertanto, zsh usa /etc/zshrc e /etc/zshenv; csh usa /etc/
           scripts                      csh.cshrc, /etc/csh.login e /etc/csh.logout . Le man pages di questi
                                        programmi documentano i les che utilizzano.


          Per bash, potrebbe esservi attivare il "completamento automatico" nel le /etc/bash.bashrc
          (semplicemente vi basterà decommentare poche righe).


                    BASILARE            Molti interpreti di comandi supportano la funzionalità di completamento
           Completamento                automatico che consente ad una shell di completare automaticamente il nome di
                                        un comando o l’argomento parzialmente inserito quando l’utente lo richiederà
           automatico                   attraverso il tasto tab. In questo modo gli utenti potranno lavorare più
                                        velocemente e con meno rischi di errore.
                                        Questa funzionalità è molto ef cace e essibile. Difatti è possibile personalizzare
                                        il suo funzionamento per ciascun comando. Pertanto, il primo argomento
                                        con gurato per il comando apt-get dovrà essere scelto in base alla sintassi
                                        dello stesso comando, anche se non lo relazionerete ad un le (in questo esempio
                                        le possibili scelte sono fra install, remove, upgrade, ecc.).



                      BASILARE          La tilde viene spesso utilizzata per indicare la directory alla quale la variabile
           La tilde, la                 d’ambiente HOME punta (ovvero la home directory dell’utente, ad esempio
           scorciatoia per la           /home/rhertzog). Pertanto gli interpreti dei comandi sostituiscono
                                        automaticamente ~/hello.txt con /home/rhertzog/hello.txt.
           HOME
                                        La tilde consente inoltre l’accesso alle home directory degli altri utenti. Di
                                        conseguenza, ~rmas/bonjour.txt assume il signi cato di
                                        /home/rmas/bonjour.txt


          Oltre ai suddetti scripts generici, ogni utente può creare i propri les ~/.bashrc e
          ~/.bash_profile per personalizzare la propria shell. Le modi che più comuni sono la creazione di
          allases; gli aliases sono parole che vengono sostituite automaticamente durante l'esecuzione di un
          comando, il che velocizza l'invocazione dello stesso comando. Ad esempio, potrete usare l'alias la
          per utilizzarlo con il comando ls -la | less; dopodiché vi basterà immettere la per ispezionare
          dettagliatamente i contenuti di una directory.


                      BASILARE          Le variabili di ambiente vengono utilizzate per memorizzare le global settings
           Variabili d’ambiente         destinate alla shell o alle chiamate ai programmi. Sono contestuali (ogni
                                        processo ha il proprio set di variabili d’ambiente) ma ereditabili. Quest’ultima
                                        caratteristica offre l’opportunità ad una login shell di dichiarare le variabili che
                                        trasmetterà a tutti i programmi che eseguirà.



          La con gurazione delle variabili d'ambiente prede nite costituisce un elemento basilare della
          con gurazione stessa della shell. Inoltre, non tenendo in considerazione le variabili peculiari ad una speci ca
          shell, genericamente è preferibile posizionare le variabili nel le /etc/environment, dal momento che vengono
          impiegate dai vari programmi in grado di avviare una sessione shell. Tra le variabili tipicamente de nite ci sono
          ORGANIZATION, che di solito comprende il nome dell'azienda o dell'organizzazione, e HTTP_PROXY, che dichiara
          l'esistenza e l'ubicazione di un proxy HTTP.




                                            TDAH_1.0             Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 161
fi
fi
fi
     fi
                       fi
                        fi
                             fi
                                  fl
                                             fi
                                                  fi
                                                       fi
                                                            fi
                                                                   fi
                                                                        fi
                                                                             fi
                                                                              fi
                                                                                   fi
                                                                                                               fi
                                                                                                                      fi
                              SUGGERIMENTO                     Gli utenti spesso desiderano con gurare le loro login ed interactive shells allo
                          Con gurare le shell                  stesso modo. Per mettere in atto ciò, i suddetti utenti preferiscono interpretare
                          in modo identico                     (o usare come “sorgente”) il contenuto del le ~/.bashrc per il le
                                                               ~/.bash_profile. Potrete fare lo stesso con i les comuni a tutti gli utenti
                                                               (attraverso la chiamata /etc/bash.bashrc da /etc/profile/).




                         8.7. Come con gurare la stampante

                         La con gurazione della stampante ha causato molti "mal di testa" sia ad amministratori, sia ad
                         utenti. Per fortuna questi grattacapi sono ormai nella maggior parte dei casi un ricordo del passato,
                         grazie a cups, un server di stampa gratuito che utilizza il protocollo IPP (Internet Printing Protocol).

                         Questo programma è suddiviso in diversi pacchetti Debian: cups è il centrai print server; [un
                         compatibility layer, in informatica, è un'interfaccia che consente ai binari di sistemi legacy o foreign
                         di poter essere eseguiti su host che altrimenti sarebbero incompatibili] cups-bsd è un "compatibility
                         layer" che offre i comandi del tradizionale BSD printing system (il demone lpd, i comandi 1pr e 1pq,
                         ecc.); cups-client contiene una serie di programmi per l'interazione con il server (blocco o sblocco
                         di una stampante, visualizzazione o annullamento della stampa in corso, ecc.); in ne, cups-driver
                         gutenprint contiene una raccolta aggiuntiva di driver di stampa per cups.

                                          COMUNITÀ             CUPS (Common Unix Printing System) è un progetto (ed un marchio registrato)
                          CUPS                                 dell’azienda Apple.
                                                                 http://www.cups.org/


                         Dopo aver installato questi diversi pacchetti, cups può essere amministrato facilmente grazie alla
                         sua interfaccia web accessibile all'indirizzo locale: http://localhost:631. Sempre dalla sua interfaccia
                         web potrete aggiungere, eliminare e amministrare stampanti (comprese le network printers).
                         Inoltre potrete amministrare cups anche attraverso l'interfaccia gra ca fornita dall'ambiente
                         desktop. In ne, c'è anche la GUI di system-config-printer (dall'omonimo pacchetto Debian).


                                        NOTA                   cups non utilizza più l’ormai obsoleto le /etc/printcap. Pertanto i programmi
                          Obsolescenza di                      che ancora fanno af damento sul suo contenuto per scoprire l’elenco delle
                                                               stampanti accessibili falliranno la loro ricerca.
                          /etc/printcap
                                                               Per evitare questo inconveniente, cancellate questo le per creare al suo posto
                                                               un symbolic link (al riguardo andate a leggere la casella di testo “Il collegamento
                                                               simbolico” a pagina 168) al le gestito da cups /var/run/cups/printcap per
                                                               garantire la compatibilità.




                         8.8. Con gurazione del Bootloader

                         Probabilmente il vostro boot loader è già funzionale, ma non fa male conoscere come con gurarlo e
                         installarlo qualora sparisse dal Master Boot Record. Ciò può accadere dopo l'installazione di un altro
                         sistema operativo, come ad esempio Windows. La seguente informazione vi aiuterà anche a
                         modi care la con gurazione del boot loader se ne aveste bisogno.




                         Pagina 162 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
          fi
               fi
                    fi
                           fi
                                fi
                                     fi
                                           fi
                                                fi
                                                     fi
                                                          fi
                                                                  fi
                                                                       fi
                                                                                    fi
                                                                                                 fi
                                                                                                               fi
                                                                                                                       fi
                                                                                                                                    -

                    BASILARE                   Il Master Boot Record (MBR) occupa i primi 512 byte del primo disco rigido ed è
           Master boot record                  il primo elemento che viene caricato dal BIOS per conferire il controllo ad un
                                               programma in grado di effettuare il boot del sistema operativo desiderato.
                                               Generalmente, un bootloader viene installato sull’MBR rimuovendo il suo
                                               contenuto precedente


          8.8.1. Come identi care i vostri dischi


                     CULTURA                   La directory /dev/ ospita tradizionalmente i cosiddetti “special” les, che
           udev e /dev/                        rappresentano le periferiche del sistema (andate a leggere la casella di testo
                                               “Diritti di accesso ad un dispositivo” a pagina 160). In un lontano passato, era
                                               usata per contenere i special les che potevano potenzialmente essere usati.
                                               Questo tipo di approccio presentava numerosi inconvenienti, tra i quali: il
                                               numero limitato dei dispositivi utilizzati (a causa dell’elenco hardcoded dei
                                               nomi) [Hard coding (o hard-coding o hardcoding) o codi ca ssa (in italiano) è,
                                               in informatica e nello sviluppo software, la pratica di incorporare i dati
                                               direttamente nel codice sorgere di un programma o di un altro oggetto
                                               eseguibile, invece di ottenerli da sorgenti esterne o di generarli in fase di
                                               esecuzione]; l’impossibilità di conoscere quali special les erano davvero
                                               utilizzabili.
                                               Al giorno d’oggi, i special les sono gestiti interamente in modo dinamico
                                               assecondando meglio la natura delle periferiche hot-swappable del computer.
                                               [In informatica un’interfaccia hot-swap, come ad esempio l’usb, consente il
                                               collegamento e/o lo scollegamento di un dispositivo hot-swappable anche a
                                               sistema avviato]. Il kernel collabora con udev per creare o eliminare questi les
                                               quando i corrispondenti dispositivi appaiono o scompaiono. Per tale ragione
                                               /dev/ non ha più la necessità di essere persistente, difatti è un RAM-based
                                                 lesystem, all’avvio vuota e che contiene solo le voci pertinenti.
                                               Il kernel fornisce molte informazioni su un dispositivo quando viene aggiunto e
                                               rilascia una coppia di numeri (major/minor) per identi carlo. [Il numero
                                               “major”, comune per tutti i dispositivi controllati dallo stesso driver, identi ca
                                               per il kernel il tipo di dispositivo; il numero “minor” invece identi ca per il
                                               driver le caratteristiche peculiari del dispositivo in modo da renderle
                                               accessibili.] udevd utilizza queste informazioni per creare uno special le, di cui
                                               stabilisce anche il nome e le relative autorizzazioni. Può anche creare aliases ed
                                               eseguire ulteriori azioni (tra cui attività di inizializzazione o di registrazione). Il
                                               funzionamento di udevd è regolamentato da un’ampia serie di regole
                                               (personalizzabili).
                                               Attraverso i nomi assegnati dinamicamente, potrete quindi mantenere lo stesso
                                               nome di un dato dispositivo, indipendentemente dalla porta a cui è collegato o,
                                               qualora fossero collegati più dispositivi (ad esempio più dispositivi USB),
                                               indipendentemente dall’ordine in cui i dispositivi sono stati collegati
                                               (rivelandosi molto utile). La prima partizione del primo disco è solitamente
                                               chiamata /dev/sda1 per motivi di retro compatibilità, ma potrete decidere di
                                               chiamarla /dev/root-partition oppure di chiamarla in entrambi i modi
                                               contemporaneamente con gurando udevd per creare automaticamente un
                                               symbolik link.
                                               In passato, alcuni kernel modules venivano caricati automaticamente quando si
                                               tentava di accedere al le del corrispondente device. Oggi è diverso e lo special
                                                 le di una periferica non sarà presente se non viene prima caricato il modulo; il
                                               che non è molto grave in quanto la maggior parte dei moduli viene caricata
                                               all’avvio grazie al rilevamento automatico dell’hardware. Il rilevamento
                                               automatico dell’hardware però non funziona con le periferiche non rilevabili
                                               [undetectable peripherals] (come i vecchi disk drive o il mouse PS/2). Di
                                               conseguenza ricordate di aggiungere i moduli floppy, psmouse e mousedev in
                                               /etc/modules per forzarne il loro caricamento all’avvio.



          La con gurazione del bootloader deve consentirgli di identi care i diversi dischi e le loro partizioni.
          Per tale scopo Linux utilizza gli special les "block" conservati nella directory /dev/. A partire da
          Debian Squeeze, lo schema di denominazione degli hard drives è stato reso comune per tutti dallo
          stesso Kernel Linux e, di conseguenza, gli hard drives (IDE/PATA, SATA, SCSI, USB, IEEE 1394)
          sono ora rappresentati attraverso /dev/sd*.
          Ciascuna partizione è quindi rappresentata da un numero in sequenza in base alla sua posizione sul
          disco: ad esempio /dev/sda1 rappresenta la prima partizione sul primo disco, mentre /dev/sdb3
          rappresenta la terza partizione sul secondo disco.


                                                    TDAH_1.0             Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 163
fi
fi
     fi
                 fi
                      fi
                           fi
                                fi
                                     fi
                                          fi
                                               fi
                                                          fi
                                                               fi
                                                                    fi
                                                                          fi
                                                                               fi
                                                                                    fi
                                                                                         fi
                                                                                              fi
                                                                                                   fi
                                                                                                        fi
               L’architettura del PC (ovvero la "i386" e la sua cugina più giovane "amd64") è stata a lungo limitata
               all'utilizzo del formato "MS-DOS" della tabella delle partizioni, che consentiva solo quattro partizioni
               "primarie" per disco. Per superare questa limitazione, una delle suddette quattro partizioni viene
               realizzata come partizione "estesa", in modo che possa contenere partizioni "secondarie". Le
               partizioni secondarie vengono numerate con un numero maggiore o uguale a 5. Di conseguenza la
               prima partizione secondaria sarà la /dev/sda5, seguita dalla partizione /dev/sda6 e così via.

               Un'altra limitazione della tabella delle partizioni MS-DOS è che non supporta dischi di dimensioni
               superiori a 2 TB, causando un notevole disagio con i dischi recenti.

               GPT, un nuovo formato della tabella delle partizioni, consente di superare i summenzionati vincoli
               sul numero di partizioni (supporta no a 128 partizioni) e sulla dimensione dei dischi (che può
               arrivare no a 8 zebibyte, che equivale a più di 8 miliardi di terabyte). Pertanto, se prevedete di
               creare più partizioni siche sullo stesso disco, dovrete creare una tabella delle partizioni in formato
               GPT durante la fase di partizionamento.

               Purtroppo non è sempre facile ricordare quale disco avete collegato ad un dato controller SATA
               oppure alla terza posizione della SCSI chain, in quanto la denominazione degli hard drives
               hotplugged (ovvero la maggior parte dei dischi SATA e delle unità esterne) può cambiare da avvio ad
               avvio. Fortunatamente, udev crea, in aggiunta a /dev/sd*, dei symbolic links con nomi ssi, che se
               utilizzati possono identi care in maniera univoca gli hard drives. I suddetti symbolic links sono
               memorizzati in /dev/disk/by-id/. Ad esempio su una macchina con due dischi sici, potrete trovare:

               mirexpress:/dev/disk/by-id# ls -l
               total
               lrwxrwxrwx 1 root root 9 23 jul. 08:58 ata-STM3500418AS_9VM3L3KP -> ../../sd
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 ata-STM3500418AS_9VM3L3KP-part1
               -> ../../sda
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 ata-STM3500418AS_9VM3L3KP-part2
               -> ../../sda
               [...
               lrwxrwxrwx 1 root root 9 23 jul. 08:58 ata-WDC_WD5001AALS-00L3B2_WD-WCAT00241697
               -> ../../sd
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 ata-WDC_WD5001AALS-00L3B2_WD-
               WCAT00241697-part1 -> ../../sdb
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 ata-WDC_WD5001AALS-00L3B2_WD-
               WCAT00241697-part2 -> ../../sdb
               [...
               lrwxrwxrwx 1 root root 9 23 jul. 08:58 scsi-SATA_STM3500418AS_9VM3L3KP
               -> ../../sda
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 scsi-SATA_STM3500418AS_9VM3L3KP-part1
               -> ../../sda
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 scsi-SATA_STM3500418AS_9VM3L3KP-part2
               -> ../../sda
               [...
               lrwxrwxrwx 1 root root 9 23 jul. 08:58 scsi-SATA_WDC_WD5001AALS-_WD-
               WCAT00241697 -> ../../sd
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 scsi-SATA_WDC_WD5001AALS-_WD-
               WCAT00241697-part1 -> ../../sdb
               lrwxrwxrwx 1 root root 10 23 jul. 08:58 scsi-SATA_WDC_WD5001AALS-_WD-
               WCAT00241697-part2 -> ../../sdb2




               Pagina 164 Il Manuale dell’Amministratore di Debian TDAH_1.0
]

]

]

     0

          fi
                 b

                      2

                      1

                      2

                      1

                       

                           fi
                                fi
                                     b

                                          fi
                                               2

                                               1

                                               1

                                                     

                                                                                   fi
                                                                                             fi
                                                                                                      a

                                         [...
                                         lrwxrwxrwx 1 root root 9 23 jul. 16:48 usb-LaCie_iamaKey_3ed00e26ccc11a-0:0 -
                                         ../../sd
                                         lrwxrwxrwx 1 root root 10 23 jul. 16:48 usb-LaCie_iamaKey_3ed00e26ccc11a-0:0-
                                         part1 -> ../../sdc
                                         lrwxrwxrwx 1 root root 10 23 jul. 16:48 usb-LaCie_iamaKey_3ed00e26ccc11a-0:0-
                                         part2 -> ../../sdc2 [...
                                         lrwxrwxrwx 1 root root 9 23 jul. 08:58 wwn-0x5000c50015c4842f -> ../../sda
                                         lrwxrwxrwx 1 root root 10 23 jul. 08:58 wwn-0x5000c50015c4842f-part1 -> ../../
                                         sda1
                                         [...
                                         mirexpress:/dev/disk/by-id

                                         Occorre precisare che alcuni dischi vengono elencati più volte (perché funzionano sia come dischi
                                         ATA, sia come dischi SCSI), ma le informazioni più rilevanti sono principalmente il modello ed il
                                         numero di serie dei dischi, attraverso cui potrete risalire al peripheral le.

                                         I les di con gurazione utilizzati come esempio nei successivi paragra sono tutti basati sulla
                                         medesima con gurazione: un singolo disco SATA, in cui la prima partizione è dedicata ad una
                                         vecchia installazione di Windows, mentre la seconda è dedicata a Debian GNU/Linux.


                                         8.8.2. Con gurazione di LILO

                                         LILO (Linux LOader) è il più vecchio bootloader — solido ma rustico. Il bootloader scrive sul MBR
                                         l'indirizzo sico del kernel per il boot; ecco perché ogni aggiornamento del kernel (o del le di
                                         con gurazione di LILO) deve essere seguito dal comando 1i1o. Non dimenticatevene in quanto il
                                         sistema non sarà in grado di avviarsi se avrete rimosso o sostituito il vecchio kernel, in particolare
                                         perché il nuovo kernel non si troverà nella stessa posizione sul disco.
                                         Il le di con gurazione di LILO è /etc/lilo.conf; nell'esempio seguente troverete un semplice le
                                         con con gurazione standard.

                                                                             Esempio 8.3 File di con gurazione LILO

                                         # The disk on which LILO should be installed.
                                         # By indicating the disk and not a partition.
                                         # you order LILO to be installed on the MBR.
                                         boot=/dev/sda
                                         # the partition that contains Debian
                                         root=/dev/sda2
                                         # the item to be loaded by default
                                         default=Linux


                                         # the most recent kernel image
                                         image=/vmlinuz
                                          label=Linux
                                          initrd=/initrd.img




                                                                            TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 165
fi
     fi
          fi
               ]

               ]

                

                    fi
                         c

                              fi
                               fi
                                    fi
                                         fi
                                              fi
                                                   fi
                                                        1

                                                             fi
                                                                  ]

                                                                       #

                                                                                                             fi
                                                                                                                  fi
                                                                                                                                   fi
                                                                                                                                           

                                                                                                                                               fi
                                                                                                                                                    >

                              read onl

                              Old kernel if the newly installed kernel doesn’t boot)
                              image=/vmlinuz.old
                                label=LinuxOLD
                                initrd=/initrd.img.old
                                read-only
                                optiona

                              # only for Linux/Windows dual boot
                              other=/dev/sda1
                                    label-Windows


                              8.8.3. La con gurazione di GRUB 2

                              GRUB (GRand Uni ed Bootloader) è il più recente bootloader. Non dovrete invocarlo dopo ogni
                              aggiornamento del kernel in quanto in grado di leggere i les system e di trovare autonomamente la
                              posizione del kernel sul disco. Per installarlo sul MBR del primo disco, dovrete semplicemente
                              digitare grub-install /dev/sda.

                                               NOTA                                        GRUB è in grado di identi care gli hard drives grazie alle informazioni fornite
                                I nomi dei dischi con                                      dal BIOS. (hd0) corrisponde al primo disco rilevato, (hd1) al secondo, ecc. Nella
                                                                                           maggior parte dei casi, questo ordine corrisponde esattamente al consueto
                                GRUB
                                                                                           ordine dei dischi in Linux, ma possono sorgere delle anomalie quando si
                                                                                           utilizzano sia dischi SCSI, sia dischi IDE.
                                                                                           GRUB salva le corrispondenze che trova nel le /boot/grub/device.map.
                                                                                           Qualora troviate nel suddetto le degli errori (perché consapevoli che il BIOS
                                                                                           rileva i dischi in un altro ordine) dovrete correggerli manualmente ed eseguire
                                                                                           di nuovo grub-install.grub-mkdevicemap vi aiuterà a creare un le
                                                                                           device.map da cui iniziare. Le partizioni in GRUB inoltre hanno un nome
                                                                                           speci co. Se utilizzerete le partizioni “classiche” in formato MS-DOS, la prima
                                                                                           partizione del primo disco sarà (hd0, msdos1), la seconda (hd0 msdos2) e così
                                                                                           via.


                              La con gurazione di GRUB 2 è conservata nel le /boot/grub/grub.cfg, ma questo le in Debian è
                              generato da altri les. Fate quindi attenzione a non modi carlo manualmente, poiché perdereste le
                              modi che locali apportate alla successiva esecuzione di update-grub (che avviene durante
                              l'aggiornamento dei diversi pacchetti). Le modi che più comuni al le /boot/grub/grub.cfg (ad
                              esempio per aggiungere dei parametri in riga di comando per il kernel o per cambiare il tempo di
                              visualizzazione del menu) vengono realizzate attraverso le variabili de nite in /etc/default/grub.
                              Per aggiungere delle voci al menu, potrete creare un le /boot/grub/custom.cfg oppure
                              modi care il le /etc/grub.d/50_custom. Per personalizzazioni più complesse, potrete aggiungere
                              o modi care altri les in /etc/grub.d/; questi scripts dovrebbero restituirvi dei con guration
                              snippets, possibilmente usufruendo di programmi esterni. [Nella programmazione gli "snippets"
                              sono dei frammenti di codice.] Questi scripts aggiorneranno per primi l'elenco dei kernels per il boot:
                              10_linux si occupa dei kernels Linux installati, 20_1inux_xen si occupa dei sistemi di
                              virtualizzazione Xen e 30_os-prober si occupa di altri sistemi operativi (Windows , OS X, Hurd).




                              Pagina 166 Il Manuale dell’Amministratore di Debian TDAH_1.0
 

 

     fi
          fi
          fi
               fi
               fi
                    y

                         l

                               fi
                                    fi
                                          

                                              fi
                                                   fi
                                                         

                                                             fi
                                                                   

                                                                        

                                                                             

                                                                            fi
                                                                                 fi
                                                                                       

                                                                                            fi
                                                                                                  

                                                                                                      fi
                                                                                                           fi
                                                                                                                fi
                                                                                                                     fi
                                                                                                                      fi
                                                                                                                           fi
                                                                                                                                fi
                                                                                                                                      

                                                                                                                                          fi
                                                                                                                                               fi
                                                                                                                                                    fi
                    8.8.4. Macintosh (PowerPC): con gurazione Yaboot

                    Yaboot è il boot loader utilizzato dai vecchi computer Macintosh con processori PowerPC. Non si
                    avviano come i PC, ma fanno af damento su una partizione bootstrap, da cui il BIOS (o
                    OpenFirmware) esegue il loader e su cui il programma ybin installa yaboot ed il suo le di
                    con gurazione. Dovrete eseguire il suddetto comando nuovamente solo se il le /etc/yaboot.conf è
                    stato modi cato (difatti viene duplicato sulla partizione di bootstrap; yaboot è in grado di trovare la
                    posizione dei kernels sui dischi).
                    Prima di eseguire ybin, è necessario disporre di un le /etc/yaboot.conf valido. A seguire un esempio
                    di con gurazione minimale.


                                                                                                         Esempio 8.4 File di con gurazione di Yaboot

                    # bootstrap partitio
                    boot=/dev/sda
                    # the dis
                    device=hd
                    # the Linux partitio
                    partition=
                    root=/dev/sda
                    # boot after 3 seconds of inactivit
                    # (timeout is in tenths of seconds
                    timeout=3

                    install=/usr/lib/yaboot/yaboo
                    magicboot=/usr/lib/yaboot/ofboo
                    enablecdboo

                    # last kernel installe
                    image=/vmlinu
                            label=linu
                            initrd=/initrd.im
                            read-onl

                    # old kerne
                    image=/vmlinux.ol
                            label=ol
                            initrd=/initrd.img.ol
                            read-onl

                    # only for Linux/Mac OSX dual-boo
                    macosx=/dev/sda

                    # bsd=/dev/sdaX and macos=/dev/sda
                    # are also possible




                                                                                                         TDAH_1.0        Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 167
fi
     fi
          fi
               :

               k

               0

                    3

                         t

                         l

                              2

                              3

                              x

                                   5

                                        y

                                        d

                                        y

                                             fi
                                                  d

                                                       x

                                                            fi
                                                                 n

                                                                 n

                                                                      d

                                                                           fi
                                                                                g

                                                                                     fi
                                                                                          t

                                                                                          d

                                                                                               t

                                                                                                    t

                                                                                                         )

                                                                                                         X

                                                                                                              y

                                                                                                                    fi
                                                                                                                                                      fi
                                                                                                                                                                  fi
               8.9. Altre con gurazioni: sincronizzazione dell'orologio, logs, condivisione ...

               Questo paragrafo riunisce molti elementi utili per padroneggiare tutti gli aspetti della con gurazione
               del sistema GNU/Linux. Tuttavia sono stati trattati brevemente e spesso rimandano alla
               documentazione di riferimento.


               8.9.1. Timezone — Fuso orario
                          BASILARE                                                Un symbolic link è un pointer ad un altro le. [In informatica un pointer è un
                Il collegamento                                                   oggetto del linguaggio di programmazione che conserva un memory address,
                                                                                  ovvero un riferimento ad una speci ca posizione della memoria.] Quando
                simbolico
                                                                                  utilizzate un pointer, viene aperto il le a cui “punta”. Inoltre la rimozione del
                                                                                  suddetto collegamento non cancella il le “puntato”. Allo stesso tempo, non ha
                                                                                  un proprio “set of permissions”, bensì adotta i permessi del target a cui punta. In
                                                                                  conclusione, può puntare a qualsiasi tipo di le: directory, special le (socket,
                                                                                  named pipes, device le, ecc.) o persino ad un altro symbolic link ...
                                                                                  Il comando ln -s target link-name crea un symbolic link con un name-link
                                                                                  che punta al target de nito nello stesso comando.
                                                                                  Se il target non esiste, il collegamento sarà “broken” [“broken” tradotto
                                                                                  letteralmente in italiano signi ca “rotto”] e se lo utilizzerete vi restituirà un
                                                                                  errore che ribadirà l’inesistenza del le richiesto. Se il collegamento punta ad un
                                                                                  altro collegamento otterrete una “chain” (“catena”) di collegamenti, che si
                                                                                  trasformerà in un “cycle” (“ciclo”) se uno dei targets, a sua volta, punta ad uno
                                                                                  dei collegamenti che lo hanno preceduto. In quest’ultimo caso, se utilizzerete
                                                                                  uno dei collegamenti del cycle otterrete un errore speci co (“too many levels of
                                                                                  symbolic links” ovvero “troppo livelli di collegamenti simbolici”), in quanto il
                                                                                  kernel interromperà il cycle dopo averlo eseguito diverse volte.




               Il fuso orario, con gurato durante l'installazione iniziale, è un elemento di con gurazione per il
               pacchetto tzdata. Per modi carlo, dovrete utilizzare il comando dpkg-reconfigure tzdata, che
               vi consentirà, di scegliere in modo interattivo il fuso orario. La sua con gurazione è memorizzata nel
                 le /etc/timezone. Inoltre, il le corrispondente della directory /usr/share/zoneinfo/ viene copiato
               in /etc/localtime; questo le contiene nello speci co le regole che amministrano la modi ca dell'ora
               per quei paesi che applicano l'ora legale.
               Per modi care temporaneamente il fuso orario, potrete utilizzare la variabile d'ambiente TZ, che
               acquisisce una priorità rispetto alle impostazioni di sistema prede nite.


               $ date
               Thu Feb 19 11:25:18 CET 2015
               $ TZ="Pacífic/Honolulu" date
               Thu Feb 19 00:25:21 HST 2015




                                NOTA                                              In realtà ci sono due sorgenti per l’ora in un computer. La scheda madre del
                Orologio di sistema,                                              computer ha un orologio hardware, noto come “CMOS clock”. Questo orologio
                                                                                  non è molto preciso ed offre tempi di accesso piuttosto lenti. Il kernel del sistema
                orologio hardware                                                 operativo possiede a sua volta un proprio orologio, l’orologio di sistema, che
                                                                                  aggiorna l’orario con i propri mezzi (possibilmente utilizzando dei time servers,
                                                                                  andate a vedere il paragrafo 8.9.2, “Sincronizzazione dell’orologio” a pagina
                                                                                  169). L’orologio di sistema è generalmente più accurato, in particolare perché
                                                                                  non necessita dell’accesso alle hardware variables. Tuttavia, poiché viene
                                                                                  conservato solo nella live memory, viene azzerato ad ogni avvio, a differenza
                                                                                  dell’orologio CMOS, che ha una batteria e che quindi “sopravvive” al riavvio o
                                                                                  allo spegnimento della macchina.

               Pagina 168 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
      

          fi
                 fi
                      fi
                           fi
                                fi
                                     fi
                                          fi
                                               fi
                                                    fi
                                                         fi
                                                              fi
                                                              fi
                                                                   fi
                                                                         

                                                                         

                                                                             fi
                                                                                  fi
                                                                                            fi
                                                                                                 fi
                                                                                                         fi
                                                                                                                 fi
                                                                                                                      fi
                                                                                                                               fi
                                                                                                                                         fi
                                                                                                                                              fi
                                           L’orologio di sistema, all’avvio del computer, viene pertanto impostato in base
                                           all’orologio CMOS, e l’orologio CMOS, a sua volta, viene aggiornato con lo
                                           spegnimento [“shutdown”] (per salvare cambiamenti o correzioni qualora non
                                           fosse stato in precedenza regolato propriamente).
                                           In pratica, il problema consiste nel fatto che l’orologio CMOS è solo un contatore
                                           e non contiene informazioni sul fuso orario. Dovrete quindi scegliere se
                                           “interpretarlo” come “tempo coordinato universale” o “tempo civile”(UTC, in
                                           precedenza GMT) oppure come “ora locale”. La suddetta scelta dovrebbe essere
                                           semplice, ma di fatto le cose sono più complicate poiché il cambio dell’ora legale
                                           (Daylight Saving Time - DST) non è costante; la conseguenza è che il sistema non
                                           ha modo di determinare se è corretto l’offset, in particolare nei periodi in cui il
                                           cambio di orario è prossimo. Pertanto vi consigliamo vivamente di impostare
                                           l’orologio CMOS con il “tempo coordinato universale” essendo tra l’altro sempre
                                           possibile risalire all’ora locale dall’ora e dal fuso orario universali.
                                           Sfortunatamente, i sistemi Windows (nella loro con gurazione prede nita) non
                                           consentono di applicare la summenzionata raccomandazione; mantengono
                                           l’orologio CMOS impostato con l’ora locale ed applicano il cambio dell’ora
                                           durante il boot del computer, prevedendo nei periodi in cui è prossimo il cambio
                                           dell’ora se già è in atto o meno. Questo sistema funziona relativamente bene
                                             ntanto sul computer è caricato solo Windows. Difatti non appena il computer
                                           utilizza diversi sistemi (sia in dual-boot o attraverso macchine virtuali), ne
                                           consegue il caos ed in nessun modo potrete avere la certezza che l’ora è corretta.
                                           Se dovete necessariamente mantenere Windows su un computer, dovrete
                                           con gurarlo in modo che il CMOS clock sia impostato come UTC (con gurando il
                                           registry key
                                           HKLM\SYSTEM\CurrentControlSet\Control\TimeZoneInformation\RealTi
                                           meIsUniversal a “1” come DWORD), oppure utilizzando hwclock --localtime
                                           --set sul sistema Debian per con gurare l’orologio hardware per il
                                           tracciamento dell’ora locale (ma veri cate l’orologio hardware manualmente in
                                           primavera ed in autunno).
                                           [Una dword, che è l’abbreviazione di “double word”, è una typedef (una parola
                                           chiave dei sistemi di programmazione C e C++ utilizzata per assegnare dei nomi
                                           alternativi a dei tipi di dati esistenti) speci ca dei sistemi Microsoft Windows.]



          8.9.2. Sincronizzazione dell'orologio

          La sincronizzazione dell'orologio, che può sembrare super ua su un computer, invece è davvero
          importante in una rete. Dal momento che gli utenti non hanno il diritto di modi care la data e l'ora, è
          importante che queste informazioni siano accurate in modo da scongiurare il caos. Inoltre, se tutti i
          computers di una rete sono sincronizzati il cross-referecing delle informazioni ottenute dai logs sulle
          differenti macchine sarà migliore. Di conseguenza, qualora avvenisse un attacco, sarà più semplice
          ricostruire la sequenza cronologica delle azioni malevoli sulle diverse macchine compromesse. Se le
          diverse macchine non sono sincronizzate i dati statistici raccolti sulle stesse macchine non hanno
          molto senso.




                                           NTP (Network Time Protocol) consente ad una macchina di sincronizzarsi con le
                     BASILARE
                                           altre in modo abbastanza preciso, tenendo conto dei ritardi indotti dal
           NTP
                                           trasferimento delle informazioni sulla rete e da altri possibili offsets.
                                           [Molto genericamente l’offset è un numero intero che indica la distanza o lo
                                           slittamento dall’inizio di un object o di un array ad un loro dato elemento o ad
                                           una loro data posizione]. Sebbene ci siano molti servers NTP su Internet, i più
                                           popolari potrebbero essere sovraccarichi. Per questo motivo vi consigliamo di
                                           utilizzare il server NTP pool.ntp.org ossia un gruppo di macchine che funzionano
                                           come servers NTP pubblici. Potrete persino limitare il suddetto servizio ad un
                                           sotto-gruppo relativo ad un paese, ad esempio: us.pool.ntp.org per gli USA;
                                           ca.pool.ntp.org per il Canada; fr.pool.ntp.org per la Francia; ecc..
                                           Tuttavia se gestite una vasta rete vi consigliamo di installare un server NTP
                                           personale che potrete sincronizzare con i servers pubblici.
                                               TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 169
fi
     fi
                      fi
                            fi
                                 fi
                                      fi
                                                   fi
                                                                fl
                                                                     fi
                                                                          fi
                                                                                           fi
                                                        In questo caso, tutte le altre macchine della rete potranno usufruire del server
                                                        NTP interno invece di incrementare il carico dei server pubblici.
                                                        Potrete inoltre incrementare l’omogeneità degli orologi, visto che tutte le
                                                        macchine saranno sincronizzate attraverso la stessa sorgente ... una sorgente
                                                        molto vicina in termini di tempi di trasferimento nella rete.


                          8.9.2.1 Per le Workstations

                          Dato che le workstations sono riavviate regolarmente (anche per motivi di risparmio energetico), è
                          suf ciente sincronizzarle tramite NTP all'avvio. Per ottenere ciò, installate semplicemente il
                          pacchetto Debian ntpdate. Potete modi care il server NTP da utilizzare attraverso il le /etc/
                          default/ntpdate.


                          8.9.2.2 Per i servers

                          I servers vengono riavviati molto raramente ed è molto importante che l'ora di sistema sia corretta.
                          Per mantenere un orario corretto in modo permanente, dovrete installare un server NTP locale,
                          grazie al servizio offerto dal pacchetto ntp. Nella sua con gurazione prede nita, il server si
                          sincronizzerà con pool.ntp.org e supporterà le macchine della rete locale che gli richiedono l'orario.
                          Potrete con gurarlo tramite il le /etc/ntp.conf, attraverso cui, cosa più importante, potrete
                          cambiare il server NTP di riferimento. Se ci sono molti servers sulla stessa rete, potrebbe esservi
                          utile possedere un solo un time server locale che si sincronizza con i server pubblici e che nel
                          frattempo funge da sorgente agli altri servers della rete.

                              ANDANDO OLTRE             Se la sincronizzazione dell’orologio è particolarmente cruciale nella vostra rete,
                           Modulo GPS ed altre          potete equipaggiarla di un server con un modulo GPS (che richiederà l’ora dai
                                                        satelliti GPS) o un modulo DCF-77 (che sincronizzerà l’ora basandosi
                           time sources
                                                        sull’orologio atomico installato vicino a Francoforte). In questi casi, la
                                                        con gurazione del server NTP è un po’ più complicata ed è assolutamente
                                                        necessaria la consultazione della documentazione.



                          8.9.3. Log Rotation

                          Man mano che i les di log crescono, è necessario archiviarli. Un modello comune è il "rotating
                          archive": il le di log viene archiviato regolarmente e sono conservati solo i suoi ultimi archivi X.
                          logrotate, il programma responsabile per le "rotazioni", segue le direttive impartite nel le /etc/
                          logrotate.conf e tutte quelle contenute nei les della directory /etc/logrotate.d/.
                          L'amministratore può modi care questi les se desidera personalizzare la policy del log rotation
                          de nita da Debian. La man page di logrotate(1) descrive tutte le opzioni consentite nei suddetti les
                          di con gurazione. Ad esempio potreste voler incrementare il numero di les conservati durante la
                          log rotation oppure potreste desiderare di spostare i les di log in una directory speci ca dedicata
                          all'archiviazione anziché eliminarli. Potrete inoltre inviarli attraverso l’e-mail allo scopo di
                          archiviarli altrove.
                          Il programma logrotate viene eseguito quotidianamente dal programma di scheduling (o
                          scheduler) cron (descritto nel paragrafo 9.7, "Scheduling Tasks attraverso cron e atd" a pagina 205).

                          [In poche parole e molto genericamente lo scheduling è un metodo attraverso il quale un compito
                          viene distribuito da un programma (scheduler) a delle risorse che lo mettono in atto e lo
                          completano.]




                          Pagina 170 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
      fi
           fi
                fi
                     fi
                               fi
                                           fi
                                                fi
                                                         fi
                                                              fi
                                                                   fi
                                                                        fi
                                                                             fi
                                                                                             fi
                                                                                                  fi
                                                                                                            fi
                                                                                                                 fi
                                                                                                                      fi
                                                                                                                            

                                                                                                                                fi
                                                                                                                                      

          8.9.4. Condivisione dei diritti di amministratore

          Abbastanza spesso, diversi amministratori si prendono cura della stessa rete. La condivisione della
          password dell'utente root non è una soluzione molto elegante e potrebbe facilitare dei
          comportamenti scorretti a causa dell'anonimato di un account condiviso. La soluzione a questo
          problema è il programma sudo, che consente a determinati utenti di eseguire determinati comandi
          con "special rights" ["Special Rights" è anche un'espressione giuridica del common law che fa
          riferimento a leggi che concedono diritti a uno o più gruppi che non sono estesi ad altri gruppi.
          L'espressione giuridica di Special Rights assume una posizione per così dire controversa in quanto in
          contrasto con il principio di uguaglianza di tutti gli individui di fronte alla legge - può essere tradotto
          non letteralmente in questo caso come "privilegi speciali"]. Nella maggior parte degli use cases,
          sudo consente ad un utente dato di eseguire qualsiasi comando come root. Per fare questo, l'utente
          deve semplicemente eseguire il comando sudo ed autenticarsi utilizzando la propria password
          personale.
          Una volta installato, il pacchetto sudo fornisce diritti di root completi a tutti gli utenti membri del
          gruppo Unix sudo. Per delegare altri diritti, l'amministratore deve utilizzare il comando visudo, che
          consente di modi care il le di con gurazione /etc/sudoers (che invocherà l'editor di testo vi o
          qualsiasi altro editor menzionato nella variabile d'ambiente EDITOR). Aggiungendo la riga username
          ALL= (ALL) ALL l'amministratore consentirà all'utente citato nella suddetta riga di eseguire
          qualsiasi comando come root.
          Sono inoltre possibili con gurazioni più so sticate che consentono all'amministratore di condividere
          solo dei comandi speci ci a determinati utenti. Tutti i dettagli delle diverse personalizzazioni sono
          trattati nella man page sudoers(5).


          8.9.5. Elenco dei Mount Points

                                                                       In un sistema di tipo Unix come Debian, i les sono organizzati in una singola
                   BASILARE
           Mounting e                                                  gerarchia a struttura ad albero di directories. La directory / si chiama “root
                                                                       directory”; tutte le altre directories sono sottodirectories contenute dalla root
           unmounting                                                  directory. “Mounting” è un’azione attraverso cui è possibile integrare il
                                                                       contenuto di una periferica (spesso un disco rigido) nella general le tree del
                                                                       sistema [che si distingue dal binary tree]. Pertanto, per poter utilizzare un disco
                                                                       esterno per memorizzare i dati personali degli utenti dovrà essere “montato”
                                                                       nella directory /home/. Il root lesystem [il “root lesystem” è il lesystem
                                                                       contenuto nella stessa partizione dove si trova la root directory ed è il le
                                                                       system sul quale tutti i lesystems sono “mounted”] è sempre montato dal
                                                                       kernel all’avvio del computer; altri dispositivi sono spesso montati dopo l’avvio,
                                                                       durante la sequenza di startup oppure manualmente attraverso il comando
                                                                       mount.
                                                                       Alcuni dispositivi rimovibili vengono montati automaticamente dopo essere stati
                                                                       collegati, specialmente se si utilizzano gli ambienti desktop GNOME e KDE. Altri
                                                                       devono essere montati necessariamente manualmente dall’utente. Inoltre
                                                                       quest’ultimi dispositivi devono essere anche smontati (o rimossi dal le tree)
                                                                       manualmente. Agli utenti di basso pro lo non è consentito utilizzare i comandi
                                                                       mount ed unmount. L’amministratore può tuttavia autorizzare queste operazioni
                                                                       (indipendentemente per ciascun mount point) con gurando l’opzione user nel
                                                                         le /etc/fstab.
                                                                       Il comando mount può essere utilizzato senza argomenti (vi elencherà di
                                                                       conseguenza tutti i lesystems montati). I seguenti parametri sono richiesti per
                                                                       il montaggio o lo smontaggio di un device. Per un elenco completo fate
                                                                       riferimento alle correlate man pages, mount(8) e unmount(8). Per usi basilari,
                                                                       la sintassi è semplice: per esempio, per montare la partizione /dev/sdc1, il cui
                                                                         lesystem è un ext3, nella directory /mnt/tmp/, dovrete solamente digitare
                                                                       mount -t ext3 /dev/sdc1 /mnt/tmp/ .


          Il le /etc /fstab fornisce l'elenco di tutti i possibili mounts eseguiti automaticamente all'avvio o da
          eseguire manualmente per i dispositivi di archiviazione rimovibili. Ogni mount point è descritto da
          una riga con diversi elds (space-separated):

          • device to mount (dispositivo da montare): può essere una partizione locale (un disco rigido, un CD-
          Rom) oppure un le system remoto (NFS).



                                                                               TDAH_1.0   Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 171
fi
fi
     fi
               fi
               fi
                    fi
                         fi
                              fi
                                   fi
                                        fi
                                             fi
                                              fi
                                                   fi
                                                        fi
                                                             fi
                                                             fi
                                                                  fi
                                                                          fi
                                                                                fi
                                                                                     fi
                                                                                                 fi
                                                                                                      fi
                                                                                                           fi
                                                                                                                fi
                                                                                                                                                       

          Il suddetto eld è spesso sostituito dall'identi catore univoco ID del lesystem (che può essere
          ottenuto con blkid device) con il pre sso UUID =. Ciò eviterà la modi ca del nome del dispositivo
          qualora aggiungiate o rimuoviate dei dischi o qualora i dischi vengano rilevati in un ordine diverso.

          • mount point (punto di mount): questa è la posizione nel lesystem locale in cui il dispositivo, il
          sistema remoto o la partizione saranno montati;
          • type: questo eld de nisce il lesystem utilizzato sul dispositivo montato. ext4, ext3, vfat, ntfs,
          btrfs, xfs sono solo alcuni esempi.


                   BASILARE                                     NFS - Network File System - è un network lesystem; sotto Linux, consente un
           NFS, un le system                                    “transparent access” ai les remoti integrandoli nel lesystem locale. [Per
           di rete                                              transparent access si intende che a prescindere dalla modalità di accesso ogni
                                                                singolo utente potrà usufruire delle risorse in modo univoco ed uniforme].



          L'elenco completo dei lesystems riconosciuti è disponibile nella man page mount (8). Lo special
          value swap indica le partizioni swap; lo special value auto dichiara al programma mount di rilevare
          automaticamente il lesystem (ciò è particolarmente utile sia per i lettori di dischi, sia per le
          chiavette USB, in quanto ciascuno di questi dispositivi potrebbe ospitare un diverso lesystem);

          • options: sono numerose, dipendono dal lesystem e sono documentate nella man page mount. Le
          più comuni sono:

                            - rw o ro rispettivamente indicano che il lesystem sarà montato con permessi di read/write
                            (lettura/scrittura) o con permessi read-only (solo lettura);

                            - noauto disabilita il mount automatico all'avvio;

                            - nofail indica al boot di procedere anche se il dispositivo non è presente. Non dovete
                            dimenticare questa opzione per i dischi esterni che possono essere disconnessi all'avvio,
                            altrimenti systemd interromperà il processo di boot no a quando tutti i mount points da
                            montare automaticamente non vengono effettivamente montati. Si precisa che potete
                            coniugare la sopra menzionata opzione con x-systemd.device-timeout=5s per
                            trasmettere a systemd di non attendere per più di 5 secondi che il dispositivo sia connesso
                            (andate a leggere systemd.mount(5));

                            - user autorizza tutti gli utenti a montare questo lesystem (operazione solitamente
                            riservata a root);

                            - defaults indica l'insieme di opzioni prede nite (rw, suid, dev, exec, auto, nouser e
                            async), che possono essere disabilitate individualmente aggiungendo dopo defaults le opzioni
                            nosuid, no-dev, ecc. per disabilitare rispettivamente suid, dev, ecc. e così via ... L'opzione
                            user abilita nuovamente i defaults (in quanto l'opzione defaults include anche nouser).

          • backup: questo eld è quasi sempre impostato a O. Quando è impostato a 1, dichiara al tool dump
          che la partizione contiene i dati di cui eseguire il backup.

          • check order: quest'ultimo eld indica se deve essere veri cata l'integrità del lesystem all'avvio e
          in quale ordine di successione dovrebbe essere eseguita tale veri ca. Se è impostato a O, non viene
          eseguita alcuna veri ca. Il root lesystem dovrebbe essere con gurato con un valore pari ad 1,
          mentre gli altri lesystem permanenti dovrebbero essere impostati con un valore pari a 2.




          Pagina 172 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
             fi
                  fi
                       fi
                            fi
                             fi
                                  fi
                                       fi
                                       fi
                                            fi
                                                 fi
                                                      fi
                                                           fi
                                                                fi
                                                                     fi
                                                                          fi
                                                                               fi
                                                                                    fi
                                                                                         fi
                                                                                              fi
                                                                                                   fi
                                                                                                        fi
                                                                                                             fi
                                                                                                                  fi
                                                                                                                       fi
                                                                                                                            fi
                                                                                                                                 fi
                                                                                                                                      fl
                                                                                                                                           fi
                                              Esempio 8.5 Esempio di un le /etc/fstab

          # /etc/fstab: static file system information

          # <file system>          <mount point>      <type>     <options>            <dump>                                            <pass>
          proc                      /proc              proc       defaults               0                                                 0
          # / was on /dev/sda1 during installation
          UUID=c964222e-6af1-4985-be04-19d7c764d0a7      / ext3 errors=remount-ro 0 1
          # swap was on /dev/sda5 during installation
          UUID=ee880013-0f63-4251-b5c6-b771f53bd90e none swap sw                         0                                                 0
          /dev/scd0                 /media/cdrom0   udf,iso9660 user,noauto              0                                                 0
          /dev/fd0                  /media/floppy   auto       rw,user,noauto            0                                                 0
          arrakis:/shared           /shared         nfs        defaults                  0                                                 0

          L'ultima voce in questo esempio corrisponde ad un lesystem di rete (NFS): la directory /shared/
          del server arrakis è montata sulla directory /shared/ della macchina locale. Il formato del le
          /etc/fstab è documentato nella man page fstab(5)

             ANDANDO OLTRE            Il pacchetto am-utils supporta l’utility amd auto-mounting, che è in grado di
           Auto-mounting              montare i dispositivi rimovibili su richiesta quando un utente tenta di accedere
                                      al loro consueto mount point. E smonterà tali dispositivi automaticamente se
                                      nessun processo vi sta accedendo. Esistono altre utilities auto-mounting, ad
                                      esempio automount del pacchetto autofs.
                                      Si precisa inoltre che gli ambienti desktop GNOME e KDE utilizzano udisks e
                                      possono montare automaticamente i dispositivi rimovibili quando vengono
                                      connessi.



          8.9.6. locate e updatedb

          Il comando locate può trovare la posizione di un le del quale conoscete solo parzialmente il nome.
          Restituisce un risultato quasi istantaneamente perché consulta un particolare database che
          memorizza la posizione di tutti i les nel sistema; questo database viene aggiornato quotidianamente
          dal comando updatedb. Esistono diverse implementazioni del comando locate e Debian ha scelto
          mlocate per il suo sistema standard.
          mlocate è abbastanza veloce e, anche se si serve di un database che gli consente di conoscere di tutti
          i les sul sistema (in quanto la sua implementazione updatedb viene eseguita con autorizzazioni
          root), restituisce all'utente che avvia il comando solo i les che sono accessibili all'utente stesso. Per
          ragioni di sicurezza, l'amministratore può escludere determinate directories dall'indicizzazione,
          utilizzando la variabile PRUNEDPATHS nel le di con gurazione /etc/updatedb.conf.




          8.10. Come compilare un kernel

          I kernels supportati da Debian includono il maggior numero possibile di funzionalità, così come la
          maggior parte di drivers, allo scopo di comprendere la più ampia gamma di con gurazioni hardware

                                             TDAH_1.0              Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 173
#

     fi
                      fi
                           fi
                                fi
                                        fi
                                                

                                                     

                                                         .

                                                         fi
                                                              fl
                                                              fi
                                                                     fi
                                                                                                    fi
                                                                                                           

                                                                                                                     fi
                                                                                                                               

                                                                                                                               

                                                                                                                               

                                                                                                                               

                                                                                                                                    

                                                                                                                                    

esistenti. Per questo alcuni utenti preferiscono ricompilare il kernel per includere solo gli elementi di
cui necessitano veramente. Ci sono due ragioni per una decisione simile. Innanzitutto, potrebbe
essere attuata per ottimizzare il consumo di memoria, in quanto il codice kernel, anche se non viene
mai utilizzato, occupa memoria per nulla (e non si trasferirà mai nella swap, perché utilizza
l'effettiva RAM), il che potrebbe ridurre le prestazioni complessive del sistema. Un kernel compilato
localmente può limitare il rischio di problemi di sicurezza in quanto il codice compilato e che verrà
processato è una frazione minore del codice kernel standard.

              NOTA            Se scegliete di compilare un vostro kernel, dovrete accettarne le conseguenze:
 Aggiornamenti di             Debian non fornirà aggiornamenti di sicurezza per il vostro kernel
                              personalizzato. Rimanendo con un kernel supportato da Debian, bene cerete
 sicurezza
                              degli aggiornamenti preparati dal team Debian Project’s security.

La ricompilazione del kernel è anche necessaria se si desidera utilizzare diverse funzionalità che
sono solo disponibili sotto forma di patch (e non sono incluse nella versione standard del kernel).

   ANDANDO OLTRE              I teams Debian Kernel gestiscono il “Debian Kernel Handbook” (disponibile nel
 Debian Kernel                pacchetto debian debian-kernel-handbook), che contiene una vasta
 Handbook                     documentazione sulla maggior parte delle kernel tasks e su come vengono gestiti
                              i Debian kernel packages. Il “Debian Kernel Handbook” è il primo posto dove
                              cercare se avete bisogno di più informazioni rispetto a quelle trattate da questo
                              capitolo.
                                 http://kernel-handbook.alioth.debian.org



8.10.1. Introduzione e Prerequisiti

Debian notoriamente gestisce il kernel sotto forma di pacchetto, pur non essendo un modo
"tradizionale" per compilare ed installare un kernel. Dal momento che il kernel è sotto il controllo del
packaging system, può essere effettuata una sua rimozione pulita oppure può essere "deployed" su
diverse macchine [ovvero può essere installato e con gurato su diverse macchine e nel frattempo
addestrato il personale al suo utilizzo durante la sua stessa installazione]. Inoltre, gli scripts
associati a questi pacchetti automatizzano l'interazione con il bootloader e l'initrd generator. [In
informatica initrd (initial ramdisk) è uno schema per caricare nella ram un temporary root le
system, utilizzato come parte del processo di avvio di Linux.]
Le sorgenti upstream del kernel Linux contengono tutto quello che è necessario per compilare un
pacchetto Debian del kernel. Dovrete anche installare il pacchetto build-essential, per garantirvi
di avere gli strumenti richiesti per generare un pacchetto Debian. Inoltre, la con gurazione del
kernel vi richiederà il pacchetto libncurses5-dev. In ne, il pacchetto fakeroot creerà il pacchetto
Debian senza usare i diritti di amministratore.




            CULTURA           Prima che il Linux build system fosse capace di generare un pacchetto Debian il
 I bei vecchi tempi           metodo raccomandato per creare questi pacchetti era utilizzare il tool make-
 del kernel-package           kpkg del pacchetto kernel-package.




8.10.2. Come recuperare le Sorgenti

Anche le sorgenti del kernel Linux sono disponibili sotto forma di pacchetto, come del resto altre
utilità del sistema Debian. Per recuperare le sorgenti, dovrete installare soltanto il pacchetto linux
source-version.




Pagina 174 Il Manuale dell’Amministratore di Debian TDAH_1.0
                                              fi
                                                   fi
                                                         fi
                                                                           fi
                                                                                         fi
                                                                                                 -

               Attraverso il comando apt-cache search ^linux-source otterrete l'elenco delle diverse versioni
               del kernel "packaged" ("impacchettate") da Debian. Le versioni più recenti sono disponibili nella
               distribuzione Unstable: potrete recuperale senza grandi rischi (specialmente se APT è stato
               con gurato seguendo le istruzioni del paragrafo 6.2.6, "Come utilizzare più distribuzioni" a pagina
               114). Si precisa che i codici sorgente contenuti in questi pacchetti non corrispondono esattamente a
               quelli pubblicati da Linus Torvalds e dagli sviluppatori del kernel; come tutte le distribuzioni anche
               Debian applica un certo numero di patch che, non è detto, durante il loro iter, debbano trovarsi nelle
               versioni upstream di Linux. Queste modi che includono: backports di xes/features/drivers dalla
               versione più recente del kernel Linux; nuove funzionalità non ancora integrate nella upstream
               Linux tree; nonché alcune funzionalità speci che di Debian.
               La parte successiva di questo capitolo sarà focalizzata sulla versione del kernel Linux 3.16, ma
               ovviamente potrete adattare gli esempi alla speci ca versione del kernel che desiderate.
               Presumiamo che abbiate installato il pacchetto linux-source-3.16. Questo pacchetto contiene il
                le /usr/src/linux-source-3.16.tar.xz, un archivio compresso di sorgenti del kernel. Dovrete
               decomprimere questi les in una nuova directory (e non direttamente in /usr/src, in quanto non
               sono necessari i permessi speciali per compilare un kernel Linux): ~/kernel/ sarà adatta.

               $ mkdir ~/kernel; cd ~/kernel
               $ tar -xaf /usr/src/linux-source-3.16.tar.xz


                               CULTURA              Tradizionalmente, le sorgenti del kernel Linux dovrebbero essere collocate in
                    Posizione delle                 /usr/src/linux, con conseguenti permessi di root per la compilazione.
                                                    Tuttavia, come sapete, dovreste evitare di utilizzare i diritti di amministratore,
                    sorgenti del kernel
                                                    se non è strettamente necessario. In teoria il gruppo src consente ai suoi
                                                    membri di utilizzare la directory /usr/src/, ma dovreste evitare comunque di
                                                    farlo. Mantenendo le sorgenti del kernel in una directory personale, ne
                                                    guadagnerete in sicurezza sotto ogni punto di vista: nessuno dei les /usr/ sarà
                                                    sconosciuto al packaging system e non rischierete di fuorviare i programmi che
                                                    scansionano /usr/src/linux per ottenere informazioni sul kernel utilizzato.



               8.10.3. Con gurazione del kernel

               Il prossimo passo che dovrete compiere è con gurare il kernel in base alle vostre esigenze. L'esatta
               procedura da eseguire dipende dai traguardi che intendete raggiungere.
               È probabile che durante la ricompilazione di una versione più recente del kernel (possibilmente con
               una patch aggiuntiva) scegliate una con gurazione quanto più possibile vicina a quella standard
               offerta da Debian. In questo caso, invece di ricon gurare tutto da zero, dovrete semplicemente
               copiare il le /boot/con g-version (ovvero la versione del kernel attualmente in uso, riscontrabile
               attraverso il comando uname -r) in un le .con g nella directory delle sorgenti del kernel:

               $ cp /boot/config-3.16.0-amd64 ~/kernel/linux-source-3.16/.config

               Se non desiderate modi care la soprastante con gurazione, potete fermarvi qui e passare
               direttamente al paragrafo 8.10.4, "Compiling [letteralmente "compilazione"] e Building
               [letteralmente "costruzione", "generazione"] di un pacchetto" a pagina 176. Altrimenti se avete
               deciso di ricon gurare tutto da zero, dovrete soffermarvi a con gurare il vostro kernel.




                                                               TDAH_1.0                       Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 175
fi
     fi
          fi
               fi
                     fi
                           fi
                                fi
                                     fi
                                          fi
                                                

                                                    fi
                                                     fi
                                                          fi
                                                                fi
                                                                     fi
                                                                          fi
                                                                               fi
                                                                                    fi
                                                                                         fi
                                                                                                  

                                                                                                      fi
                                                                                                           fi
                                                                                                                   fi
                    Esistono diverse interfacce dedicate, nella directory "kernel source" [letteralmente "sorgente del
                    Kernel"], che possono essere chiamate utilizzando il comando make target, dove
                    "target" [letteralmente "bersaglio"] è uno dei valori descritti in seguito.

                    make menuconfig compila ed esegue un’interfaccia in modalità testuale (ed è necessario il
                    pacchetto libncurses5-dev) che consente di "navigare" fra le opzioni supportate in una struttura
                    gerarchica. Premendo il tasto Space modi cherete il valore dell'opzione selezionata, mentre
                    premendo il tasto Enter convaliderete il pulsante selezionato nella parte inferiore dello schermo:
                    Select vi restituirà il sottomenu selezionato; Exit chiuderà la schermata corrente e ritornerà
                    indietro ripercorrendo a ritroso la gerarchia; Help vi mostrerà delle informazioni più dettagliate
                    riguardo al ruolo dell'opzione selezionata. I tasti frecce vi consentiranno di spostarvi tra l'elenco
                    di opzioni e pulsanti. Per uscire dal programma di con gurazione dovrete selezionare Exit dal menu
                    principale. Dopodiché il programma vi proporrà di salvare le modi che, che accetterete se vi
                    riterrete soddisfatti delle scelte effettuate.

                    Le altre interfacce hanno funzionalità simili, ma hanno interfacce gra che più moderne:
                    make xconfig utilizza l'interfaccia gra ca Qt e make gconfig utilizza GTK+. La prima necessita di
                    libqt4-dev mentre la seconda dipende da libglade2-dev e libgtk2.0-dev.

                    Quando si utilizza una di queste interfacce di con gurazione, è generalmente consigliabile iniziare da
                    una con gurazione prede nita ragionevole. Il kernel fornisce tali con gurazioni in arch/
                    architecture/configs/*_defconfig ed è possibile impostarle con un comando come make
                    x86_64_defconfig (per un PC a 64 bit) o make_i386_defconfig (per un PC a 32 bit).




                         SUGGERIMENTO                         Se utilizzerete un le .con g generato da un’altra versione del kernel (più
                     Cosa fare con un                         vecchia), dovrete aggiornare quel le. Potrete farlo attraverso make oldconfig,
                      le .con g obsoleto?                     che vi porrà in modalità interattiva delle domande sulle nuove opzioni di
                                                              con gurazione. Per utilizzare le risposte prede nite a tutte le suddette domande,
                                                              potrete usare make olddefconfig. In ne, il comando make oldnoconfig farà
                                                              in modo che le risposte a tutte le suddette domande siano negative.




                    8.10.4. Compiling [letteralmente "compilazione"] e Building [letteralmente "costruzione",
                    "generazione"] di un pacchetto



                                   NOTA                       Se avete già effettuato una compilazione del kernel nella directory e desiderate
                     Rimozione pulita                         ricominciare tutto da capo (ad esempio perché avete modi cato la
                                                              con gurazione del kernel), dovrete eseguire make clean, che eliminerà i les
                     prima di un
                                                              compilati. make distclean eseguirà una pulizia ancora più accurata ed
                     rebuilding                               eliminerà tutti i les generati, incluso il vostro le .con g, pertanto fate prima un
                                                              backup.


                    Quando la con gurazione del kernel sarà pronta, il comando make deb-pkg creerà no a 5 pacchetti
                    Debian: linux-image-version, che contiene l'immagine del kernel ed i moduli correlati; linux
                    headers-version, che contiene i les header necessari per compilare i moduli esterni; linux
                    firmware-image-version, che contiene i les del rmware richiesti da alcuni drivers (questo
                    pacchetto potrebbe non essere incluso se si genera il kernel dalle sorgenti offerte da Debian); linux
                    image-version-dbg, che contiene i debugging symbols per la kernel image e per i suoi moduli, e
                    linux-libc-dev, che contiene gli headers speci ci di alcune librerie user-space, come ad esempio la
                    libreria GNU glibc.

                    Pagina 176 Il Manuale dell’Amministratore di Debian TDAH_1.0
fi
     fi
     fi
          fi
               fi
                      fi
                           fi
                                fi
                                     fi
                                          fi
                                               fi
                                                    fi
                                                         fi
                                                              fi
                                                                   fi
                                                                    fi
                                                                        fi
                                                                             fi
                                                                                  fi
                                                                                       fi
                                                                                            fi
                                                                                                 fi
                                                                                                      fi
                                                                                                           fi
                                                                                                                fi
                                                                                                                     fi
                                                                                                                          fi
                                                                                                                               fi
                                                                                                                                    fi
                                                                                                                                          

                                                                                                                                               

                                                                                                                                                   -

                                                                                                                                                        -

                                                                                                                                                             -

                         La versione viene de nita attraverso il concatenamento della versione upstream (ovvero viene
                         de nita attraverso le variabili VERSION, PATCHLEVEL, SUBLEVEL ed EXTRAVERSION nel le
                         Makefile), dal parametro di con gurazione LOCALVERSION e dalla variabile d'ambiente
                         LOCALVERSION. [Un makefile è un le attraverso cui viene gestito il frazionamento del programma
                         make] La versione del pacchetto riutilizza la stessa "version string" con una revisione che viene
                         regolarmente incrementata (e conservata nel le .version), a meno che non ne eseguiate l’override
                         attraverso la variabile di ambiente KDEB_PKGVERSION.

                         $ make deb-pkg LOCALVERSION=-falcot KDEB_PKGVERSION=$(make kernelversion) -
                         [...]
                         $ ls ../*.deb
                         ../linux-headers-3.16.7-ckt4-falcot_3.16.7-1_amd64.deb
                         ../linux-image-3.16.7-ckt4-falcot_3.16.7-1_amd64.deb
                         ../linux-image-3.16.7-ckt4-falcot-dbg_3.16.7-1_amd64.deb
                         ../linux-libc-dev_3.16.7-1_amd64.deb


                         8.10.5. Compilazione dei moduli esterni

                         Alcuni moduli sono manutenuti al di fuori del kernel Linux uf ciale. Per usarli dovranno essere
                         compilati insieme al kernel corrispondente. Una gran quantità di moduli di terzi sono offerti da
                         Debian in pacchetti dedicati, come xtables-addons-source (moduli aggiuntivi per iptables) o
                         oss4-source (ovvero Open Sound System, con diversi drivers audio alternativi).

                         I pacchetti esterni sono molti e persino variegati fra loro, pertanto non li elencheremo tutti; il
                         comando apt-cache search source$ vi consentirà di restringere il campo di ricerca. In ogni caso,
                         questo elenco non sarà particolarmente utile, dal momento che non esiste un motivo particolare per
                         compilare i moduli, tranne che siate a conoscenza di averne bisogno. Nel qual caso la
                         documentazione del dispositivo vi speci cherà dettagliatamente i moduli necessari per funzionare
                         con Linux.

                         Ad esempio date un'occhiata al pacchetto xtables-addons-source: dopo la sua installazione, un le
                         .tar.bz2 delle sorgenti del modulo è archiviato in /usr/src/. Si potrebbe estrarre il tarball e
                         generare il modulo, ma è consuetudine automatizzare il tutto con DKMS. La maggior parte dei
                         moduli offre la necessaria integrazione con DKMS attraverso un pacchetto il cui nome termina con il
                         suf sso -dkms. Riprendendo il soprastante esempio, vi basterà installare il pacchetto xtables
                         addons-dkms per compilare il kernel module per il kernel corrente, a condizione che abbiate
                         installato anche il pacchetto linux-headers-* idoneo al kernel corrente. Per esempio, per usare
                         linux-image-amd64, dovrete installare anche linux-headers-amd64.


                         sudo apt install xtables-addons-dkms

                         [...
                         Setting up xtables-addons-dkms (2.6-1) ..
                         Loading new xtables-addons-2.6 DKMS files ...
                         First Installation: checking all kernels ...
                         Building only for 3.16.0-4-amd64
                         Building initial module for 3.16 O-4-amd64
                         Done

                         xt_ACCOUNT:




                                                                  TDAH_1.0         Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 177
 

     fi
          fi
               ]

               .

                     

                           

                                

                                    fi
                                         fi
                                              fi
                                                   fi
                                                        fi
                                                              

                                                                     

                                                                     

                                                                         fi
                                                                              .

                                                                                     

                                                                                          

                                                                                               

                                                                                                   fi
                                                                                                         

                                                                                                              

                                                                                                                   

                                                                                                                              fi
                                                                                                                                       -

                                                                                                                                        1

                                                                                                                                             fi
               Running module version sanity check.
                - Original module
                  - No original module exists within this kernel
                - Installation
                  - Installing to /lib/modules/3.16.0–amd64/updates/dkms/
               [...
               DKMS: install completed.
               $ sudo dkms status
               xtables-addons, 2.6, 3.16.0-4-amd64, x86_64: installed
               $ sudo modinfo xt_ACCOUNT
               filename:       /lib/modules/3.16.0-4-amd64/updates/dkms/xt_ACCOUNT.ko
               license:        GPL
               alias:          ipt_ACCOUNT
               author:         Intra2net AG <opensource@intra2net.com>
               description:    Xtables: per-IP accounting for large prefixe
               [...]



                    ALTERNATIVA                      Prima della comparsa di DKMS, il module-assistant era la soluzione più
                module-assistant                     semplice per la creazione ed il deployment dei kernel modules.
                                                     Questa soluzione è ancora utilizzata, in particolare per i pacchetti che non
                                                     offrono ancora l’integrazione con DKMS: con un semplice comando come ad
                                                     esempio module-assistant auto-install xtables-addons (o la versione
                                                     abbreviata m-a a-i xtables-addons), i moduli saranno compilati per il kernel
                                                     corrente, posti in un nuovo pacchetto Debian, che a sua volta sarà installato al
                                                     volo.


               8.10.6. Come applicare una patch del kernel

               Alcune funzionalità non sono incluse nel kernel standard in quanto non ancora mature o per un
               disaccordo fra i manutentori del kernel. Di conseguenza alcune funzionalità potrebbero essere
               rilasciate sotto forma di patch, in modo che chiunque possa liberamente applicarle alle sorgenti del
               kernel.
               Debian distribuisce alcune di queste patches attraverso i pacchetti linux-patch-* o kernel
               patch_* (ad esempio, linux-patch-grsecurity2, intensi ca le security policies del kernel).
               Questi pacchetti installano i les nella directory /usr/src/kernel-patches/.
               Per applicare una o più patches installate, dovrete utilizzare il comando patch nella directory delle
               sorgenti e poi avviare la compilazione del kernel come descritto precedentemente.

               $ cd ~/kernelflinux-source-3.16
               $ make clean
               $ zcat /usr/src/kernel-patches/diffs/grsecurity2/
               grsecurity-3.0-3.17.1-201410250027.patch.gz | patch -p1

               Si precisa che una patch potrebbe non funzionare necessariamente con tutte le versioni dei kernel; è
               quindi possibile che la patch non riesca ad "applicarsi" alle sorgenti del kernel. Vi apparirà quindi un
               messaggio di errore che vi darà dei dettagli in merito: in questo caso, fate riferimento alla
               documentazione disponibile nel pacchetto Debian della patch (nella directory /usr/share/doc/
               linux-patch-*/). È probabile che il manutentore speci chi a quali versioni del kernel la patch era
               destinata.




               Pagina 178 Il Manuale dell’Amministratore di Debian TDAH_1.0
]

      

           

                   

                        

                             

                             

                             

                                 fi
                                       

                                            

                                                 

                                                      

                                                             

                                                                        fi
                                                                             fi
                                                                                   

                                                                                   

                                                                                        

                                                                                        

                                                                                             

                                                                                                  

                                                                                                      s

                                                                                                            

                                                                                                                 -

                                                                                                                       

     8.11. Installazione di un kernel


     8.11.1. Funzionalità di Debian Kernel Package

     Un Debian Kernel Package installa la kernel image (vmlinuz-version), la sua con gurazione
     (config-version) e la sua symbols table (System.map-version) in /boot/. La symbols table
     consente agli sviluppatori di comprendere il signi cato di un messaggio di errore del kernel; in
     assenza di una "symbols table" i "kernel oopses" - (un "oops" è l'equivalente kernel di un
     "segmentation fault" dei programmi dell'user-space, in altre parole questi messaggi sono
     conseguenti ad una dereferenziazione di un puntatore "non valido") - conterrebbero solo indirizzi di
     memoria numerici, che rappresenterebbero un'informazione inutile senza una "tabella" che si occupa
     del mapping tra questi indirizzi ed i symbols ed i function names. I moduli sono installati nella
     directory /lib/modules/version/.

     [Molto genericamente: il "kernel oop" è un errore dovuto al funzionamento del kernel non
     appropriato, poi riportato come "error log" — il famoso "Kernel Panic" è la conseguenza a molti
     "kernel oopses" —; un "segmentation fault" o "errore di segmentazione" è un errore dovuto al
     fatto che un programma tenta di accedere, senza i relativi e dovuti permessi, ad una posizione della
     memoria.]

     Gli scripts di con gurazione del pacchetto generano automaticamente un’initrd image, che è un
     mini-system designato per essere caricato in memoria (da qui il nome "init ramdisk") dal
     bootloader ed usato dal kernel Linux al solo scopo di caricare i moduli necessari per accedere ai
     dispositivi contenenti il sistema Debian completo (ad esempio il driver per i dischi SATA). In ne, gli
     scripts post-installazione aggiornano i "symbolic links" (i collegamenti simbolici) /vmlinuz,
     /vmlinuz.old, /initrd.img e /initrd.img.old in modo che puntino rispettivamente agli ultimi
     due kernel installati ed alle loro corrispondenti immagini initrd.

     La maggior parte di queste attività sono delegate agli "hook scripts" contenuti nelle directories
     /etc/kernel/*.d/. [Molto genericamente gli "hook scripts" sono dei programmi che si attivano
     a seguito di un repository event]. Ad esempio, l'integrazione attraverso grub si basa su
     /etc/kernel/postinst.d/zz-update-grub e su /etc/kernel/postrm.d/zz-update-grub, per
     chiamare update-grub quando i kernels vengono installati o rimossi.


     8.11.2. Installazione con dpkg

     Usare apt è così conveniente da far dimenticare facilmente i tools di più basso livello, tuttavia il
     modo più semplice per installare un compiled kernel è usare il comando dpkg -i package.deb
     dove package.deb rappresenta ovviamente il nome di un pacchetto linux-image come ad esempio
     linux-image-3.16.7-ckt4-falcot_1_amd64.deb.

     Le fasi di con gurazione descritte in questo capitolo sono basilari tanto da poter essere destinate ad
     un server nonché ad una workstation, e replicate massivamente in modo semi-automatico. Tuttavia,
     tali fasi non sono suf cienti di per sé a garantire un fully con gured system. Difatti occorre ancora
     con gurare altro, a partire dai programmi di basso livello chiamati "Unix services" ("servizi Unix").




                                    TDAH_1.0    Capitolo VIII - Con gurazione di base: rete, accounts, stampa ... Pagina 179
fi
      fi
           fi
                fi
                     fi
                                           fi
                                                         fi
                                                                                     fi
                                                                                                 fi
              Parole chiave
Avvio del sistema
Initscripts
SSH
Telnet
Diritti (Rights)
Permissions (Autorizzazioni)
Supervisione
Inetd
Cron
Backup
Hotplug
PCMCIA
APM
ACPI
